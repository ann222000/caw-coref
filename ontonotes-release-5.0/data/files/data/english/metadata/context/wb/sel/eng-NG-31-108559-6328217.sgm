<DOC>
<DOCID> eng-NG-31-108559-6328217 </DOCID>
<DOCTYPE SOURCE="usenet"> USENET TEXT </DOCTYPE>
<DATETIME> 2007-02-05T00:53:00 </DATETIME>
<BODY>
<HEADLINE>
Opto-couplers in smps - part 3 (final chapter)
</HEADLINE>
<TEXT>
<POST>
<POSTER> "Steve" &lt;stefan.toftev...@bredband.net&gt; </POSTER>
<POSTDATE> 2007-02-05T00:53:00 </POSTDATE>
Hi once again,

I've find an optocoupler called TCET 1102 G.
According to its datasheet, this coupler has an Fc of 110kHz.
Datasheet: http://www.dzsc.com/pdf_down.asp?id=642422
Will this mean I may use it in my smps loop which has a unity gain
frequency of 3kHz.

Regards
</POST>
<POST>
<POSTER> Eeyore &lt;rabbitsfriendsandrelati...@hotmail.com&gt; </POSTER>
<POSTDATE> 2007-02-05T02:19:00 </POSTDATE>
<QUOTE PREVIOUSPOST="
Steve wrote:
&gt; Hi once again,

&gt; I've find an optocoupler called TCET 1102 G.
&gt; According to its datasheet, this coupler has an Fc of 110kHz.
&gt; Datasheet: http://www.dzsc.com/pdf_down.asp?id=642422
">

110kHz with a diode current of 10mA and a load resistance of 100 ohms. I suspect
you're unlikely to be using it like that.

<QUOTE PREVIOUSPOST="
&gt; Will this mean I may use it in my smps loop which has a unity gain
&gt; frequency of 3kHz.
">

It won't have an Fc of 110kHz most likely under the conditions you're likely to
be using it I reckon.

Graham
</POST>
<POST>
<POSTER> Terry Given &lt;my_n...@ieee.org&gt; </POSTER>
<POSTDATE> 2007-02-05T02:58:00 </POSTDATE>
<QUOTE PREVIOUSPOST="
Eeyore wrote:

&gt; Steve wrote:

&gt;&gt;Hi once again,

&gt;&gt;I've find an optocoupler called TCET 1102 G.
&gt;&gt;According to its datasheet, this coupler has an Fc of 110kHz.
&gt;&gt;Datasheet: http://www.dzsc.com/pdf_down.asp?id=642422

&gt; 110kHz with a diode current of 10mA and a load resistance of 100 ohms. I suspect
&gt; you're unlikely to be using it like that.

&gt;&gt;Will this mean I may use it in my smps loop which has a unity gain
&gt;&gt;frequency of 3kHz.

&gt; It won't have an Fc of 110kHz most likely under the conditions you're likely to
&gt; be using it I reckon.

&gt; Graham
">

wot he said. Its trivial to measure the -3dB frequency response of the
opto in your circuit; do so. That way you'll KNOW the phase shift the
opto introduces.

Conversely its astonishingly hard to measure the total loop response
unless you have a fancy wodgy. thats wy step responses are often used
(and why said wodgies exist).

you can also do this: run the smps from an isolated supply, and
completely bypass the opto. Do a step response, check its fine, then put
the opto back in and do it again. you'll pretty soon see if the opto
adds too much phase shift.

Cheers
Terry
</POST>
<POST>
<POSTER> "Steve" &lt;stefan.toftev...@bredband.net&gt; </POSTER>
<POSTDATE> 2007-02-05T05:48:00 </POSTDATE>
On 5 Feb, 08:58, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

<QUOTE PREVIOUSPOST="
&gt; Eeyore wrote:

&gt; &gt; Steve wrote:

&gt; &gt;&gt;Hi once again,

&gt; &gt;&gt;I've find an optocoupler called TCET 1102 G.
&gt; &gt;&gt;According to its datasheet, this coupler has an Fc of 110kHz.
&gt; &gt;&gt;Datasheet: http://www.dzsc.com/pdf_down.asp?id=642422

&gt; &gt; 110kHz with a diode current of 10mA and a load resistance of 100 ohms. I suspect
&gt; &gt; you're unlikely to be using it like that.

&gt; &gt;&gt;Will this mean I may use it in my smps loop which has a unity gain
&gt; &gt;&gt;frequency of 3kHz.

&gt; &gt; It won't have an Fc of 110kHz most likely under the conditions you're likely to
&gt; &gt; be using it I reckon.

&gt; &gt; Graham

&gt; wot he said. Its trivial to measure the -3dB frequency response of the
&gt; opto in your circuit; do so. That way you'll KNOW the phase shift the
&gt; opto introduces.

&gt; Conversely its astonishingly hard to measure the total loop response
&gt; unless you have a fancy wodgy. thats wy step responses are often used
&gt; (and why said wodgies exist).

&gt; you can also do this: run the smps from an isolated supply, and
&gt; completely bypass the opto. Do a step response, check its fine, then put
&gt; the opto back in and do it again. you'll pretty soon see if the opto
&gt; adds too much phase shift.

&gt; Cheers
&gt; Terry- Dölj citerad text -

&gt; - Visa citerad text -
">

Though it seems like a good opto for this purpose?
</POST>
<POST>
<POSTER> "Paul Mathews" &lt;o...@whidbey.com&gt; </POSTER>
<POSTDATE> 2007-02-05T10:35:00 </POSTDATE>
On Feb 5, 2:48 am, "Steve" &lt;stefan.toftev ... @bredband.net&gt; wrote:

<QUOTE PREVIOUSPOST="
&gt; On 5 Feb, 08:58, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt; &gt; Eeyore wrote:

&gt; &gt; &gt; Steve wrote:

&gt; &gt; &gt;&gt;Hi once again,

&gt; &gt; &gt;&gt;I've find an optocoupler called TCET 1102 G.
&gt; &gt; &gt;&gt;According to its datasheet, this coupler has an Fc of 110kHz.
&gt; &gt; &gt;&gt;Datasheet: http://www.dzsc.com/pdf_down.asp?id=642422

&gt; &gt; &gt; 110kHz with a diode current of 10mA and a load resistance of 100 ohms. I suspect
&gt; &gt; &gt; you're unlikely to be using it like that.

&gt; &gt; &gt;&gt;Will this mean I may use it in my smps loop which has a unity gain
&gt; &gt; &gt;&gt;frequency of 3kHz.

&gt; &gt; &gt; It won't have an Fc of 110kHz most likely under the conditions you're likely to
&gt; &gt; &gt; be using it I reckon.

&gt; &gt; &gt; Graham

&gt; &gt; wot he said. Its trivial to measure the -3dB frequency response of the
&gt; &gt; opto in your circuit; do so. That way you'll KNOW the phase shift the
&gt; &gt; opto introduces.

&gt; &gt; Conversely its astonishingly hard to measure the total loop response
&gt; &gt; unless you have a fancy wodgy. thats wy step responses are often used
&gt; &gt; (and why said wodgies exist).

&gt; &gt; you can also do this: run the smps from an isolated supply, and
&gt; &gt; completely bypass the opto. Do a step response, check its fine, then put
&gt; &gt; the opto back in and do it again. you'll pretty soon see if the opto
&gt; &gt; adds too much phase shift.

&gt; &gt; Cheers
&gt; &gt; Terry- Dölj citerad text -

&gt; &gt; - Visa citerad text -

&gt; Though it seems like a good opto for this purpose?- Hide quoted text -

&gt; - Show quoted text -
">

Yes, although 100 kHz is about the usual fc for most optos operating
at around 1 mA LED bias and loaded on the phototransistor side such
that saturation is avoided. If you're connecting the LED anode to your
p.s. output without intermediate filtering, note that the frequency
characteristics of the circuit driving the cathode will not
necessarily dominate. For example, the classic TL431 integrator
driving the cathode can be understood to provide something like an AC
ground at the cathode at high frequencies, with the optocoupler then
coupling h.f. ripple on the LED anode directly to the output
phototransistor. The resulting midband rise in feedback has probably
saved more than a few designs and thrashed as many others.
Paul Mathews
</POST>
<POST>
<POSTER> "Steve" &lt;stefan.toftev...@bredband.net&gt; </POSTER>
<POSTDATE> 2007-02-05T23:53:00 </POSTDATE>
On 5 Feb, 16:35, "Paul Mathews" &lt;o ... @whidbey.com&gt; wrote:

<QUOTE PREVIOUSPOST="
&gt; On Feb 5, 2:48 am, &quot;Steve&quot; &lt;stefan.toftev ... @bredband.net&gt; wrote:

&gt; &gt; On 5 Feb, 08:58, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt; &gt; &gt; Eeyore wrote:

&gt; &gt; &gt; &gt; Steve wrote:

&gt; &gt; &gt; &gt;&gt;Hi once again,

&gt; &gt; &gt; &gt;&gt;I've find an optocoupler called TCET 1102 G.
&gt; &gt; &gt; &gt;&gt;According to its datasheet, this coupler has an Fc of 110kHz.
&gt; &gt; &gt; &gt;&gt;Datasheet: http://www.dzsc.com/pdf_down.asp?id=642422

&gt; &gt; &gt; &gt; 110kHz with a diode current of 10mA and a load resistance of 100 ohms. I suspect
&gt; &gt; &gt; &gt; you're unlikely to be using it like that.

&gt; &gt; &gt; &gt;&gt;Will this mean I may use it in my smps loop which has a unity gain
&gt; &gt; &gt; &gt;&gt;frequency of 3kHz.

&gt; &gt; &gt; &gt; It won't have an Fc of 110kHz most likely under the conditions you're likely to
&gt; &gt; &gt; &gt; be using it I reckon.

&gt; &gt; &gt; &gt; Graham

&gt; &gt; &gt; wot he said. Its trivial to measure the -3dB frequency response of the
&gt; &gt; &gt; opto in your circuit; do so. That way you'll KNOW the phase shift the
&gt; &gt; &gt; opto introduces.

&gt; &gt; &gt; Conversely its astonishingly hard to measure the total loop response
&gt; &gt; &gt; unless you have a fancy wodgy. thats wy step responses are often used
&gt; &gt; &gt; (and why said wodgies exist).

&gt; &gt; &gt; you can also do this: run the smps from an isolated supply, and
&gt; &gt; &gt; completely bypass the opto. Do a step response, check its fine, then put
&gt; &gt; &gt; the opto back in and do it again. you'll pretty soon see if the opto
&gt; &gt; &gt; adds too much phase shift.

&gt; &gt; &gt; Cheers
&gt; &gt; &gt; Terry- Dölj citerad text -

&gt; &gt; &gt; - Visa citerad text -

&gt; &gt; Though it seems like a good opto for this purpose?- Hide quoted text -

&gt; &gt; - Show quoted text -

&gt; Yes, although 100 kHz is about the usual fc for most optos operating
&gt; at around 1 mA LED bias and loaded on the phototransistor side such
&gt; that saturation is avoided. If you're connecting the LED anode to your
&gt; p.s. output without intermediate filtering, note that the frequency
&gt; characteristics of the circuit driving the cathode will not
&gt; necessarily dominate. For example, the classic TL431 integrator
&gt; driving the cathode can be understood to provide something like an AC
&gt; ground at the cathode at high frequencies, with the optocoupler then
&gt; coupling h.f. ripple on the LED anode directly to the output
&gt; phototransistor. The resulting midband rise in feedback has probably
&gt; saved more than a few designs and thrashed as many others.
&gt; Paul Mathews- Dölj citerad text -

&gt; - Visa citerad text -
">

Ok
First I thought of using an op-amp with compensated feedback for
driving the led, but
since yesterday I'll try the TL431 instead.
The opto-coupler led anode will be coming right from one of the supply
lines, through dropping resistor / zenerdiode combination.
Across the zener there's a filter cap. This will bring noise down a
bit.
To the "input" of the TL431 there are a pole-zero network and across
the TL431 there's another pole-zero network and
one slope. There might come through some h.f ripple through the
compensation components across the 431.
This would surely also increase midband feedback / lowering the gain /
cause unwanted phase shift...     Oh dear.
</POST>
<POST>
<POSTER> Terry Given &lt;my_n...@ieee.org&gt; </POSTER>
<POSTDATE> 2007-02-06T05:16:00 </POSTDATE>
<QUOTE PREVIOUSPOST="
Steve wrote:
&gt; On 5 Feb, 16:35, &quot;Paul Mathews&quot; &lt;o ... @whidbey.com&gt; wrote:

&gt;&gt;On Feb 5, 2:48 am, &quot;Steve&quot; &lt;stefan.toftev ... @bredband.net&gt; wrote:

&gt;&gt;&gt;On 5 Feb, 08:58, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt;&gt;&gt;&gt;Eeyore wrote:

&gt;&gt;&gt;&gt;&gt;Steve wrote:

&gt;&gt;&gt;&gt;&gt;&gt;Hi once again,

&gt;&gt;&gt;&gt;&gt;&gt;I've find an optocoupler called TCET 1102 G.
&gt;&gt;&gt;&gt;&gt;&gt;According to its datasheet, this coupler has an Fc of 110kHz.
&gt;&gt;&gt;&gt;&gt;&gt;Datasheet: http://www.dzsc.com/pdf_down.asp?id=642422

&gt;&gt;&gt;&gt;&gt;110kHz with a diode current of 10mA and a load resistance of 100 ohms. I suspect
&gt;&gt;&gt;&gt;&gt;you're unlikely to be using it like that.

&gt;&gt;&gt;&gt;&gt;&gt;Will this mean I may use it in my smps loop which has a unity gain
&gt;&gt;&gt;&gt;&gt;&gt;frequency of 3kHz.

&gt;&gt;&gt;&gt;&gt;It won't have an Fc of 110kHz most likely under the conditions you're likely to
&gt;&gt;&gt;&gt;&gt;be using it I reckon.

&gt;&gt;&gt;&gt;&gt;Graham

&gt;&gt;&gt;&gt;wot he said. Its trivial to measure the -3dB frequency response of the
&gt;&gt;&gt;&gt;opto in your circuit; do so. That way you'll KNOW the phase shift the
&gt;&gt;&gt;&gt;opto introduces.

&gt;&gt;&gt;&gt;Conversely its astonishingly hard to measure the total loop response
&gt;&gt;&gt;&gt;unless you have a fancy wodgy. thats wy step responses are often used
&gt;&gt;&gt;&gt;(and why said wodgies exist).

&gt;&gt;&gt;&gt;you can also do this: run the smps from an isolated supply, and
&gt;&gt;&gt;&gt;completely bypass the opto. Do a step response, check its fine, then put
&gt;&gt;&gt;&gt;the opto back in and do it again. you'll pretty soon see if the opto
&gt;&gt;&gt;&gt;adds too much phase shift.

&gt;&gt;&gt;&gt;Cheers
&gt;&gt;&gt;&gt;Terry- Dölj citerad text -

&gt;&gt;&gt;&gt;- Visa citerad text -

&gt;&gt;&gt;Though it seems like a good opto for this purpose?- Hide quoted text -

&gt;&gt;&gt;- Show quoted text -

&gt;&gt;Yes, although 100 kHz is about the usual fc for most optos operating
&gt;&gt;at around 1 mA LED bias and loaded on the phototransistor side such
&gt;&gt;that saturation is avoided. If you're connecting the LED anode to your
&gt;&gt;p.s. output without intermediate filtering, note that the frequency
&gt;&gt;characteristics of the circuit driving the cathode will not
&gt;&gt;necessarily dominate. For example, the classic TL431 integrator
&gt;&gt;driving the cathode can be understood to provide something like an AC
&gt;&gt;ground at the cathode at high frequencies, with the optocoupler then
&gt;&gt;coupling h.f. ripple on the LED anode directly to the output
&gt;&gt;phototransistor. The resulting midband rise in feedback has probably
&gt;&gt;saved more than a few designs and thrashed as many others.
&gt;&gt;Paul Mathews- Dölj citerad text -

&gt;&gt;- Visa citerad text -

&gt; Ok
&gt; First I thought of using an op-amp with compensated feedback for
&gt; driving the led, but
&gt; since yesterday I'll try the TL431 instead.
">

it makes no difference if the LED is fed from the supply you are trying
to regulate.

<QUOTE PREVIOUSPOST="
&gt; The opto-coupler led anode will be coming right from one of the supply
&gt; lines, through dropping resistor / zenerdiode combination.
&gt; Across the zener there's a filter cap. This will bring noise down a
&gt; bit.
&gt; To the &quot;input&quot; of the TL431 there are a pole-zero network and across
&gt; the TL431 there's another pole-zero network and
&gt; one slope. There might come through some h.f ripple through the
&gt; compensation components across the 431.
&gt; This would surely also increase midband feedback / lowering the gain /
&gt; cause unwanted phase shift...     Oh dear.
">

what you have described should avoid the issue Paul mentioned.

When the opto LED circuit runs off the supply to be regulated, the
overall circuit gain is always &gt; 1 - draw a block diagram, its pretty
clear why. Even when the TL431 is a dead short, there is always the
direct path from supply thru led and series R.

with the zener pre-regulator and associated cap feeding the opto LED,
you effectively remove this path.

there is nothing "wrong" with either approach, you just need to
understand your loop before attempting to close it. As others mentioned,
most SMPS do this.

Cheers
Terry
</POST>
<POST>
<POSTER> "Steve" &lt;stefan.toftev...@bredband.net&gt; </POSTER>
<POSTDATE> 2007-02-06T13:52:00 </POSTDATE>
On 6 Feb, 11:16, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

<QUOTE PREVIOUSPOST="
&gt; Steve wrote:
&gt; &gt; On 5 Feb, 16:35, &quot;Paul Mathews&quot; &lt;o ... @whidbey.com&gt; wrote:

&gt; &gt;&gt;On Feb 5, 2:48 am, &quot;Steve&quot; &lt;stefan.toftev ... @bredband.net&gt; wrote:

&gt; &gt;&gt;&gt;On 5 Feb, 08:58, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt; &gt;&gt;&gt;&gt;Eeyore wrote:

&gt; &gt;&gt;&gt;&gt;&gt;Steve wrote:

&gt; &gt;&gt;&gt;&gt;&gt;&gt;Hi once again,

&gt; &gt;&gt;&gt;&gt;&gt;&gt;I've find an optocoupler called TCET 1102 G.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;According to its datasheet, this coupler has an Fc of 110kHz.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;Datasheet: http://www.dzsc.com/pdf_down.asp?id=642422

&gt; &gt;&gt;&gt;&gt;&gt;110kHz with a diode current of 10mA and a load resistance of 100 ohms. I suspect
&gt; &gt;&gt;&gt;&gt;&gt;you're unlikely to be using it like that.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;Will this mean I may use it in my smps loop which has a unity gain
&gt; &gt;&gt;&gt;&gt;&gt;&gt;frequency of 3kHz.

&gt; &gt;&gt;&gt;&gt;&gt;It won't have an Fc of 110kHz most likely under the conditions you're likely to
&gt; &gt;&gt;&gt;&gt;&gt;be using it I reckon.

&gt; &gt;&gt;&gt;&gt;&gt;Graham

&gt; &gt;&gt;&gt;&gt;wot he said. Its trivial to measure the -3dB frequency response of the
&gt; &gt;&gt;&gt;&gt;opto in your circuit; do so. That way you'll KNOW the phase shift the
&gt; &gt;&gt;&gt;&gt;opto introduces.

&gt; &gt;&gt;&gt;&gt;Conversely its astonishingly hard to measure the total loop response
&gt; &gt;&gt;&gt;&gt;unless you have a fancy wodgy. thats wy step responses are often used
&gt; &gt;&gt;&gt;&gt;(and why said wodgies exist).

&gt; &gt;&gt;&gt;&gt;you can also do this: run the smps from an isolated supply, and
&gt; &gt;&gt;&gt;&gt;completely bypass the opto. Do a step response, check its fine, then put
&gt; &gt;&gt;&gt;&gt;the opto back in and do it again. you'll pretty soon see if the opto
&gt; &gt;&gt;&gt;&gt;adds too much phase shift.

&gt; &gt;&gt;&gt;&gt;Cheers
&gt; &gt;&gt;&gt;&gt;Terry- Dölj citerad text -

&gt; &gt;&gt;&gt;&gt;- Visa citerad text -

&gt; &gt;&gt;&gt;Though it seems like a good opto for this purpose?- Hide quoted text -

&gt; &gt;&gt;&gt;- Show quoted text -

&gt; &gt;&gt;Yes, although 100 kHz is about the usual fc for most optos operating
&gt; &gt;&gt;at around 1 mA LED bias and loaded on the phototransistor side such
&gt; &gt;&gt;that saturation is avoided. If you're connecting the LED anode to your
&gt; &gt;&gt;p.s. output without intermediate filtering, note that the frequency
&gt; &gt;&gt;characteristics of the circuit driving the cathode will not
&gt; &gt;&gt;necessarily dominate. For example, the classic TL431 integrator
&gt; &gt;&gt;driving the cathode can be understood to provide something like an AC
&gt; &gt;&gt;ground at the cathode at high frequencies, with the optocoupler then
&gt; &gt;&gt;coupling h.f. ripple on the LED anode directly to the output
&gt; &gt;&gt;phototransistor. The resulting midband rise in feedback has probably
&gt; &gt;&gt;saved more than a few designs and thrashed as many others.
&gt; &gt;&gt;Paul Mathews- Dölj citerad text -

&gt; &gt;&gt;- Visa citerad text -

&gt; &gt; Ok
&gt; &gt; First I thought of using an op-amp with compensated feedback for
&gt; &gt; driving the led, but
&gt; &gt; since yesterday I'll try the TL431 instead.

&gt; it makes no difference if the LED is fed from the supply you are trying
&gt; to regulate.

&gt; &gt; The opto-coupler led anode will be coming right from one of the supply
&gt; &gt; lines, through dropping resistor / zenerdiode combination.
&gt; &gt; Across the zener there's a filter cap. This will bring noise down a
&gt; &gt; bit.
&gt; &gt; To the &quot;input&quot; of the TL431 there are a pole-zero network and across
&gt; &gt; the TL431 there's another pole-zero network and
&gt; &gt; one slope. There might come through some h.f ripple through the
&gt; &gt; compensation components across the 431.
&gt; &gt; This would surely also increase midband feedback / lowering the gain /
&gt; &gt; cause unwanted phase shift...     Oh dear.

&gt; what you have described should avoid the issue Paul mentioned.

&gt; When the opto LED circuit runs off the supply to be regulated, the
&gt; overall circuit gain is always &gt; 1 - draw a block diagram, its pretty
&gt; clear why. Even when the TL431 is a dead short, there is always the
&gt; direct path from supply thru led and series R.

&gt; with the zener pre-regulator and associated cap feeding the opto LED,
&gt; you effectively remove this path.

&gt; there is nothing &quot;wrong&quot; with either approach, you just need to
&gt; understand your loop before attempting to close it. As others mentioned,
&gt; most SMPS do this.

&gt; Cheers
&gt; Terry- Dölj citerad text -

&gt; - Visa citerad text -
">

Hello Terry.

I get your point of the gain &gt; 1 since the power to the led comes from
the same point as the
regulation does. If led power drops, the power will increase (since
led only will limit the pulsewidth)
But I'm little confused of the difference in using a zener pre-reg.
I see it's a parallel path across the led, but........ hmmm

Most greatful for any additional comments,

Thanks!
Regards
Stefan
</POST>
<POST>
<POSTER> Terry Given &lt;my_n...@ieee.org&gt; </POSTER>
<POSTDATE> 2007-02-06T15:58:00 </POSTDATE>
<QUOTE PREVIOUSPOST="
Steve wrote:
&gt; On 6 Feb, 11:16, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt;&gt;Steve wrote:

&gt;&gt;&gt;On 5 Feb, 16:35, &quot;Paul Mathews&quot; &lt;o ... @whidbey.com&gt; wrote:

&gt;&gt;&gt;&gt;On Feb 5, 2:48 am, &quot;Steve&quot; &lt;stefan.toftev ... @bredband.net&gt; wrote:

&gt;&gt;&gt;&gt;&gt;On 5 Feb, 08:58, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt;&gt;&gt;&gt;&gt;&gt;Eeyore wrote:

&gt;&gt;&gt;&gt;&gt;&gt;&gt;Steve wrote:

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Hi once again,

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;I've find an optocoupler called TCET 1102 G.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;According to its datasheet, this coupler has an Fc of 110kHz.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Datasheet: http://www.dzsc.com/pdf_down.asp?id=642422

&gt;&gt;&gt;&gt;&gt;&gt;&gt;110kHz with a diode current of 10mA and a load resistance of 100 ohms. I suspect
&gt;&gt;&gt;&gt;&gt;&gt;&gt;you're unlikely to be using it like that.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Will this mean I may use it in my smps loop which has a unity gain
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;frequency of 3kHz.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;It won't have an Fc of 110kHz most likely under the conditions you're likely to
&gt;&gt;&gt;&gt;&gt;&gt;&gt;be using it I reckon.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;Graham

&gt;&gt;&gt;&gt;&gt;&gt;wot he said. Its trivial to measure the -3dB frequency response of the
&gt;&gt;&gt;&gt;&gt;&gt;opto in your circuit; do so. That way you'll KNOW the phase shift the
&gt;&gt;&gt;&gt;&gt;&gt;opto introduces.

&gt;&gt;&gt;&gt;&gt;&gt;Conversely its astonishingly hard to measure the total loop response
&gt;&gt;&gt;&gt;&gt;&gt;unless you have a fancy wodgy. thats wy step responses are often used
&gt;&gt;&gt;&gt;&gt;&gt;(and why said wodgies exist).

&gt;&gt;&gt;&gt;&gt;&gt;you can also do this: run the smps from an isolated supply, and
&gt;&gt;&gt;&gt;&gt;&gt;completely bypass the opto. Do a step response, check its fine, then put
&gt;&gt;&gt;&gt;&gt;&gt;the opto back in and do it again. you'll pretty soon see if the opto
&gt;&gt;&gt;&gt;&gt;&gt;adds too much phase shift.

&gt;&gt;&gt;&gt;&gt;&gt;Cheers
&gt;&gt;&gt;&gt;&gt;&gt;Terry- Dölj citerad text -

&gt;&gt;&gt;&gt;&gt;&gt;- Visa citerad text -

&gt;&gt;&gt;&gt;&gt;Though it seems like a good opto for this purpose?- Hide quoted text -

&gt;&gt;&gt;&gt;&gt;- Show quoted text -

&gt;&gt;&gt;&gt;Yes, although 100 kHz is about the usual fc for most optos operating
&gt;&gt;&gt;&gt;at around 1 mA LED bias and loaded on the phototransistor side such
&gt;&gt;&gt;&gt;that saturation is avoided. If you're connecting the LED anode to your
&gt;&gt;&gt;&gt;p.s. output without intermediate filtering, note that the frequency
&gt;&gt;&gt;&gt;characteristics of the circuit driving the cathode will not
&gt;&gt;&gt;&gt;necessarily dominate. For example, the classic TL431 integrator
&gt;&gt;&gt;&gt;driving the cathode can be understood to provide something like an AC
&gt;&gt;&gt;&gt;ground at the cathode at high frequencies, with the optocoupler then
&gt;&gt;&gt;&gt;coupling h.f. ripple on the LED anode directly to the output
&gt;&gt;&gt;&gt;phototransistor. The resulting midband rise in feedback has probably
&gt;&gt;&gt;&gt;saved more than a few designs and thrashed as many others.
&gt;&gt;&gt;&gt;Paul Mathews- Dölj citerad text -

&gt;&gt;&gt;&gt;- Visa citerad text -

&gt;&gt;&gt;Ok
&gt;&gt;&gt;First I thought of using an op-amp with compensated feedback for
&gt;&gt;&gt;driving the led, but
&gt;&gt;&gt;since yesterday I'll try the TL431 instead.

&gt;&gt;it makes no difference if the LED is fed from the supply you are trying
&gt;&gt;to regulate.

&gt;&gt;&gt;The opto-coupler led anode will be coming right from one of the supply
&gt;&gt;&gt;lines, through dropping resistor / zenerdiode combination.
&gt;&gt;&gt;Across the zener there's a filter cap. This will bring noise down a
&gt;&gt;&gt;bit.
&gt;&gt;&gt;To the &quot;input&quot; of the TL431 there are a pole-zero network and across
&gt;&gt;&gt;the TL431 there's another pole-zero network and
&gt;&gt;&gt;one slope. There might come through some h.f ripple through the
&gt;&gt;&gt;compensation components across the 431.
&gt;&gt;&gt;This would surely also increase midband feedback / lowering the gain /
&gt;&gt;&gt;cause unwanted phase shift...     Oh dear.

&gt;&gt;what you have described should avoid the issue Paul mentioned.

&gt;&gt;When the opto LED circuit runs off the supply to be regulated, the
&gt;&gt;overall circuit gain is always &gt; 1 - draw a block diagram, its pretty
&gt;&gt;clear why. Even when the TL431 is a dead short, there is always the
&gt;&gt;direct path from supply thru led and series R.

&gt;&gt;with the zener pre-regulator and associated cap feeding the opto LED,
&gt;&gt;you effectively remove this path.

&gt;&gt;there is nothing &quot;wrong&quot; with either approach, you just need to
&gt;&gt;understand your loop before attempting to close it. As others mentioned,
&gt;&gt;most SMPS do this.

&gt;&gt;Cheers
&gt;&gt;Terry- Dölj citerad text -

&gt;&gt;- Visa citerad text -

&gt; Hello Terry.

&gt; I get your point of the gain &gt; 1 since the power to the led comes from
&gt; the same point as the
&gt; regulation does. If led power drops, the power will increase (since
&gt; led only will limit the pulsewidth)
">

just examine the maths, rather than hand-wavey arguments ;)

<QUOTE PREVIOUSPOST="
&gt; But I'm little confused of the difference in using a zener pre-reg.
&gt; I see it's a parallel path across the led, but........ hmmm

&gt; Most greatful for any additional comments,

&gt;  Thanks!
&gt; Regards
&gt; Stefan
">

When you write an expression for LED current, it looks something like this:

Iled = (Vout - Vled - Vk)/Rled

Vk = (Vout - Vref)*H(s)

Vk = kathode voltage of TL431, ie the error amp output voltage (I've
carefully ignored the voltage divider here). H(s) = xfer function of
TL431 cct.

when you look at the small-signal response (perturb and toss out DC &amp;
high-order perturbation terms - IOW partial derivatives wrt Vout) Vled
disappears, as does Vref. You actually end up with:

Iled(s) = (Vout(s) - Vk(s))/Rled
^^^^^
this is the key bit here

H(s) = -Zf(s)/Rtop

Zf(s) = impedance of TL431 feedback network

Rtop = top resistor in voltage divider; the bottom resistor always has a
constant voltage = Vref across it, due to the magic of -ve feedback, so
it falls out of the equation. if you thevenise the voltage divider and
do the sums, you will see this happen.

Vk(s) = Vout(s)*H(s)

so you get:

Iled(s) = [Vout(s) - Vout(s)*H(s)]/Rled

Iled(s) = Vout(s)[1-H(s)]/Rled

now you see where the 1 comes from. Even when H(s) goes to zero, the 1
doesnt.

If you use a pre-regulator, it is:

Iled = (Vprereg - Vled - Vk)/Rled

and, by definition (the regulator bit) Vprereg has no dependance on
Vout, so its partial derivative wrt Vout = zero - it looks like an AC
short circuit.

you then end up with:

Iled(s) = -Vout(s)*H(s)/Rled

which will go to zero whenever H(s) goes to zero.

HTH

Cheers
Terry
</POST>
<POST>
<POSTER> "Steve" &lt;stefan.toftev...@bredband.net&gt; </POSTER>
<POSTDATE> 2007-02-07T00:03:00 </POSTDATE>
On 6 Feb, 21:58, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

<QUOTE PREVIOUSPOST="
&gt; Steve wrote:
&gt; &gt; On 6 Feb, 11:16, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt; &gt;&gt;Steve wrote:

&gt; &gt;&gt;&gt;On 5 Feb, 16:35, &quot;Paul Mathews&quot; &lt;o ... @whidbey.com&gt; wrote:

&gt; &gt;&gt;&gt;&gt;On Feb 5, 2:48 am, &quot;Steve&quot; &lt;stefan.toftev ... @bredband.net&gt; wrote:

&gt; &gt;&gt;&gt;&gt;&gt;On 5 Feb, 08:58, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt; &gt;&gt;&gt;&gt;&gt;&gt;Eeyore wrote:

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;Steve wrote:

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Hi once again,

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;I've find an optocoupler called TCET 1102 G.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;According to its datasheet, this coupler has an Fc of 110kHz.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Datasheet: http://www.dzsc.com/pdf_down.asp?id=642422

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;110kHz with a diode current of 10mA and a load resistance of 100 ohms. I suspect
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;you're unlikely to be using it like that.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Will this mean I may use it in my smps loop which has a unity gain
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;frequency of 3kHz.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;It won't have an Fc of 110kHz most likely under the conditions you're likely to
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;be using it I reckon.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;Graham

&gt; &gt;&gt;&gt;&gt;&gt;&gt;wot he said. Its trivial to measure the -3dB frequency response of the
&gt; &gt;&gt;&gt;&gt;&gt;&gt;opto in your circuit; do so. That way you'll KNOW the phase shift the
&gt; &gt;&gt;&gt;&gt;&gt;&gt;opto introduces.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;Conversely its astonishingly hard to measure the total loop response
&gt; &gt;&gt;&gt;&gt;&gt;&gt;unless you have a fancy wodgy. thats wy step responses are often used
&gt; &gt;&gt;&gt;&gt;&gt;&gt;(and why said wodgies exist).

&gt; &gt;&gt;&gt;&gt;&gt;&gt;you can also do this: run the smps from an isolated supply, and
&gt; &gt;&gt;&gt;&gt;&gt;&gt;completely bypass the opto. Do a step response, check its fine, then put
&gt; &gt;&gt;&gt;&gt;&gt;&gt;the opto back in and do it again. you'll pretty soon see if the opto
&gt; &gt;&gt;&gt;&gt;&gt;&gt;adds too much phase shift.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;Cheers
&gt; &gt;&gt;&gt;&gt;&gt;&gt;Terry- Dölj citerad text -

&gt; &gt;&gt;&gt;&gt;&gt;&gt;- Visa citerad text -

&gt; &gt;&gt;&gt;&gt;&gt;Though it seems like a good opto for this purpose?- Hide quoted text -

&gt; &gt;&gt;&gt;&gt;&gt;- Show quoted text -

&gt; &gt;&gt;&gt;&gt;Yes, although 100 kHz is about the usual fc for most optos operating
&gt; &gt;&gt;&gt;&gt;at around 1 mA LED bias and loaded on the phototransistor side such
&gt; &gt;&gt;&gt;&gt;that saturation is avoided. If you're connecting the LED anode to your
&gt; &gt;&gt;&gt;&gt;p.s. output without intermediate filtering, note that the frequency
&gt; &gt;&gt;&gt;&gt;characteristics of the circuit driving the cathode will not
&gt; &gt;&gt;&gt;&gt;necessarily dominate. For example, the classic TL431 integrator
&gt; &gt;&gt;&gt;&gt;driving the cathode can be understood to provide something like an AC
&gt; &gt;&gt;&gt;&gt;ground at the cathode at high frequencies, with the optocoupler then
&gt; &gt;&gt;&gt;&gt;coupling h.f. ripple on the LED anode directly to the output
&gt; &gt;&gt;&gt;&gt;phototransistor. The resulting midband rise in feedback has probably
&gt; &gt;&gt;&gt;&gt;saved more than a few designs and thrashed as many others.
&gt; &gt;&gt;&gt;&gt;Paul Mathews- Dölj citerad text -

&gt; &gt;&gt;&gt;&gt;- Visa citerad text -

&gt; &gt;&gt;&gt;Ok
&gt; &gt;&gt;&gt;First I thought of using an op-amp with compensated feedback for
&gt; &gt;&gt;&gt;driving the led, but
&gt; &gt;&gt;&gt;since yesterday I'll try the TL431 instead.

&gt; &gt;&gt;it makes no difference if the LED is fed from the supply you are trying
&gt; &gt;&gt;to regulate.

&gt; &gt;&gt;&gt;The opto-coupler led anode will be coming right from one of the supply
&gt; &gt;&gt;&gt;lines, through dropping resistor / zenerdiode combination.
&gt; &gt;&gt;&gt;Across the zener there's a filter cap. This will bring noise down a
&gt; &gt;&gt;&gt;bit.
&gt; &gt;&gt;&gt;To the &quot;input&quot; of the TL431 there are a pole-zero network and across
&gt; &gt;&gt;&gt;the TL431 there's another pole-zero network and
&gt; &gt;&gt;&gt;one slope. There might come through some h.f ripple through the
&gt; &gt;&gt;&gt;compensation components across the 431.
&gt; &gt;&gt;&gt;This would surely also increase midband feedback / lowering the gain /
&gt; &gt;&gt;&gt;cause unwanted phase shift...     Oh dear.

&gt; &gt;&gt;what you have described should avoid the issue Paul mentioned.

&gt; &gt;&gt;When the opto LED circuit runs off the supply to be regulated, the
&gt; &gt;&gt;overall circuit gain is always &gt; 1 - draw a block diagram, its pretty
&gt; &gt;&gt;clear why. Even when the TL431 is a dead short, there is always the
&gt; &gt;&gt;direct path from supply thru led and series R.

&gt; &gt;&gt;with the zener pre-regulator and associated cap feeding the opto LED,
&gt; &gt;&gt;you effectively remove this path.

&gt; &gt;&gt;there is nothing &quot;wrong&quot; with either approach, you just need to
&gt; &gt;&gt;understand your loop before attempting to close it. As others mentioned,
&gt; &gt;&gt;most SMPS do this.

&gt; &gt;&gt;Cheers
&gt; &gt;&gt;Terry- Dölj citerad text -

&gt; &gt;&gt;- Visa citerad text -

&gt; &gt; Hello Terry.

&gt; &gt; I get your point of the gain &gt; 1 since the power to the led comes from
&gt; &gt; the same point as the
&gt; &gt; regulation does. If led power drops, the power will increase (since
&gt; &gt; led only will limit the pulsewidth)

&gt; just examine the maths, rather than hand-wavey arguments ;)

&gt; &gt; But I'm little confused of the difference in using a zener pre-reg.
&gt; &gt; I see it's a parallel path across the led, but........ hmmm

&gt; &gt; Most greatful for any additional comments,

&gt; &gt;  Thanks!
&gt; &gt; Regards
&gt; &gt; Stefan

&gt; When you write an expression for LED current, it looks something like this:

&gt; Iled = (Vout - Vled - Vk)/Rled

&gt; Vk = (Vout - Vref)*H(s)

&gt; Vk = kathode voltage of TL431, ie the error amp output voltage (I've
&gt; carefully ignored the voltage divider here). H(s) = xfer function of
&gt; TL431 cct.

&gt; when you look at the small-signal response (perturb and toss out DC &amp;
&gt; high-order perturbation terms - IOW partial derivatives wrt Vout) Vled
&gt; disappears, as does Vref. You actually end up with:

&gt; Iled(s) = (Vout(s) - Vk(s))/Rled
&gt;             ^^^^^
&gt;             this is the key bit here

&gt; H(s) = -Zf(s)/Rtop

&gt; Zf(s) = impedance of TL431 feedback network

&gt; Rtop = top resistor in voltage divider; the bottom resistor always has a
&gt; constant voltage = Vref across it, due to the magic of -ve feedback, so
&gt; it falls out of the equation. if you thevenise the voltage divider and
&gt; do the sums, you will see this happen.

&gt; Vk(s) = Vout(s)*H(s)

&gt; so you get:

&gt; Iled(s) = [Vout(s) - Vout(s)*H(s)]/Rled

&gt; Iled(s) = Vout(s)[1-H(s)]/Rled

&gt; now you see where the 1 comes from. Even when H(s) goes to zero, the 1
&gt; doesnt.

&gt; If you use a pre-regulator, it is:

&gt; Iled = (Vprereg - Vled - Vk)/Rled

&gt; and, by definition (the regulator bit) Vprereg has no dependance on
&gt; Vout, so its partial derivative wrt Vout = zero - it looks like an AC
&gt; short circuit.

&gt; you then end up with:

&gt; Iled(s) = -Vout(s)*H(s)/Rled

&gt; which will go to zero whenever H(s) goes to zero.

&gt; HTH

&gt; Cheers
&gt; Terry- Dölj citerad text -

&gt; - Visa citerad text -
">

Ok, but I'm forced to use the pre-reg since the tl431 cannot withstand
this high secondary voltage.
I'm regulating somewhere around 100V.
But when you say that gain will always be &gt; 1 , in which frequency
does this apply?
I try to have a closed loop response unity gain frequency of 3kHz,
since Fswitch is only 30kHz due to the slow IGBT devices used as main
switches.
</POST>
<POST>
<POSTER> Terry Given &lt;my_n...@ieee.org&gt; </POSTER>
<POSTDATE> 2007-02-07T03:51:00 </POSTDATE>
<QUOTE PREVIOUSPOST="
Steve wrote:
&gt; On 6 Feb, 21:58, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt;&gt;Steve wrote:

&gt;&gt;&gt;On 6 Feb, 11:16, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt;&gt;&gt;&gt;Steve wrote:

&gt;&gt;&gt;&gt;&gt;On 5 Feb, 16:35, &quot;Paul Mathews&quot; &lt;o ... @whidbey.com&gt; wrote:

&gt;&gt;&gt;&gt;&gt;&gt;On Feb 5, 2:48 am, &quot;Steve&quot; &lt;stefan.toftev ... @bredband.net&gt; wrote:

&gt;&gt;&gt;&gt;&gt;&gt;&gt;On 5 Feb, 08:58, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Eeyore wrote:

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Steve wrote:

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Hi once again,

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;I've find an optocoupler called TCET 1102 G.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;According to its datasheet, this coupler has an Fc of 110kHz.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Datasheet: http://www.dzsc.com/pdf_down.asp?id=642422

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;110kHz with a diode current of 10mA and a load resistance of 100 ohms. I suspect
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;you're unlikely to be using it like that.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Will this mean I may use it in my smps loop which has a unity gain
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;frequency of 3kHz.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;It won't have an Fc of 110kHz most likely under the conditions you're likely to
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;be using it I reckon.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Graham

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;wot he said. Its trivial to measure the -3dB frequency response of the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;opto in your circuit; do so. That way you'll KNOW the phase shift the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;opto introduces.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Conversely its astonishingly hard to measure the total loop response
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;unless you have a fancy wodgy. thats wy step responses are often used
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;(and why said wodgies exist).

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;you can also do this: run the smps from an isolated supply, and
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;completely bypass the opto. Do a step response, check its fine, then put
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;the opto back in and do it again. you'll pretty soon see if the opto
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;adds too much phase shift.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Cheers
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Terry- Dölj citerad text -

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;- Visa citerad text -

&gt;&gt;&gt;&gt;&gt;&gt;&gt;Though it seems like a good opto for this purpose?- Hide quoted text -

&gt;&gt;&gt;&gt;&gt;&gt;&gt;- Show quoted text -

&gt;&gt;&gt;&gt;&gt;&gt;Yes, although 100 kHz is about the usual fc for most optos operating
&gt;&gt;&gt;&gt;&gt;&gt;at around 1 mA LED bias and loaded on the phototransistor side such
&gt;&gt;&gt;&gt;&gt;&gt;that saturation is avoided. If you're connecting the LED anode to your
&gt;&gt;&gt;&gt;&gt;&gt;p.s. output without intermediate filtering, note that the frequency
&gt;&gt;&gt;&gt;&gt;&gt;characteristics of the circuit driving the cathode will not
&gt;&gt;&gt;&gt;&gt;&gt;necessarily dominate. For example, the classic TL431 integrator
&gt;&gt;&gt;&gt;&gt;&gt;driving the cathode can be understood to provide something like an AC
&gt;&gt;&gt;&gt;&gt;&gt;ground at the cathode at high frequencies, with the optocoupler then
&gt;&gt;&gt;&gt;&gt;&gt;coupling h.f. ripple on the LED anode directly to the output
&gt;&gt;&gt;&gt;&gt;&gt;phototransistor. The resulting midband rise in feedback has probably
&gt;&gt;&gt;&gt;&gt;&gt;saved more than a few designs and thrashed as many others.
&gt;&gt;&gt;&gt;&gt;&gt;Paul Mathews- Dölj citerad text -

&gt;&gt;&gt;&gt;&gt;&gt;- Visa citerad text -

&gt;&gt;&gt;&gt;&gt;Ok
&gt;&gt;&gt;&gt;&gt;First I thought of using an op-amp with compensated feedback for
&gt;&gt;&gt;&gt;&gt;driving the led, but
&gt;&gt;&gt;&gt;&gt;since yesterday I'll try the TL431 instead.

&gt;&gt;&gt;&gt;it makes no difference if the LED is fed from the supply you are trying
&gt;&gt;&gt;&gt;to regulate.

&gt;&gt;&gt;&gt;&gt;The opto-coupler led anode will be coming right from one of the supply
&gt;&gt;&gt;&gt;&gt;lines, through dropping resistor / zenerdiode combination.
&gt;&gt;&gt;&gt;&gt;Across the zener there's a filter cap. This will bring noise down a
&gt;&gt;&gt;&gt;&gt;bit.
&gt;&gt;&gt;&gt;&gt;To the &quot;input&quot; of the TL431 there are a pole-zero network and across
&gt;&gt;&gt;&gt;&gt;the TL431 there's another pole-zero network and
&gt;&gt;&gt;&gt;&gt;one slope. There might come through some h.f ripple through the
&gt;&gt;&gt;&gt;&gt;compensation components across the 431.
&gt;&gt;&gt;&gt;&gt;This would surely also increase midband feedback / lowering the gain /
&gt;&gt;&gt;&gt;&gt;cause unwanted phase shift...     Oh dear.

&gt;&gt;&gt;&gt;what you have described should avoid the issue Paul mentioned.

&gt;&gt;&gt;&gt;When the opto LED circuit runs off the supply to be regulated, the
&gt;&gt;&gt;&gt;overall circuit gain is always &gt; 1 - draw a block diagram, its pretty
&gt;&gt;&gt;&gt;clear why. Even when the TL431 is a dead short, there is always the
&gt;&gt;&gt;&gt;direct path from supply thru led and series R.

&gt;&gt;&gt;&gt;with the zener pre-regulator and associated cap feeding the opto LED,
&gt;&gt;&gt;&gt;you effectively remove this path.

&gt;&gt;&gt;&gt;there is nothing &quot;wrong&quot; with either approach, you just need to
&gt;&gt;&gt;&gt;understand your loop before attempting to close it. As others mentioned,
&gt;&gt;&gt;&gt;most SMPS do this.

&gt;&gt;&gt;&gt;Cheers
&gt;&gt;&gt;&gt;Terry- Dölj citerad text -

&gt;&gt;&gt;&gt;- Visa citerad text -

&gt;&gt;&gt;Hello Terry.

&gt;&gt;&gt;I get your point of the gain &gt; 1 since the power to the led comes from
&gt;&gt;&gt;the same point as the
&gt;&gt;&gt;regulation does. If led power drops, the power will increase (since
&gt;&gt;&gt;led only will limit the pulsewidth)

&gt;&gt;just examine the maths, rather than hand-wavey arguments ;)

&gt;&gt;&gt;But I'm little confused of the difference in using a zener pre-reg.
&gt;&gt;&gt;I see it's a parallel path across the led, but........ hmmm

&gt;&gt;&gt;Most greatful for any additional comments,

&gt;&gt;&gt; Thanks!
&gt;&gt;&gt;Regards
&gt;&gt;&gt;Stefan

&gt;&gt;When you write an expression for LED current, it looks something like this:

&gt;&gt;Iled = (Vout - Vled - Vk)/Rled

&gt;&gt;Vk = (Vout - Vref)*H(s)

&gt;&gt;Vk = kathode voltage of TL431, ie the error amp output voltage (I've
&gt;&gt;carefully ignored the voltage divider here). H(s) = xfer function of
&gt;&gt;TL431 cct.

&gt;&gt;when you look at the small-signal response (perturb and toss out DC &amp;
&gt;&gt;high-order perturbation terms - IOW partial derivatives wrt Vout) Vled
&gt;&gt;disappears, as does Vref. You actually end up with:

&gt;&gt;Iled(s) = (Vout(s) - Vk(s))/Rled
&gt;&gt;            ^^^^^
&gt;&gt;            this is the key bit here

&gt;&gt;H(s) = -Zf(s)/Rtop

&gt;&gt;Zf(s) = impedance of TL431 feedback network

&gt;&gt;Rtop = top resistor in voltage divider; the bottom resistor always has a
&gt;&gt;constant voltage = Vref across it, due to the magic of -ve feedback, so
&gt;&gt;it falls out of the equation. if you thevenise the voltage divider and
&gt;&gt;do the sums, you will see this happen.

&gt;&gt;Vk(s) = Vout(s)*H(s)

&gt;&gt;so you get:

&gt;&gt;Iled(s) = [Vout(s) - Vout(s)*H(s)]/Rled

&gt;&gt;Iled(s) = Vout(s)[1-H(s)]/Rled

&gt;&gt;now you see where the 1 comes from. Even when H(s) goes to zero, the 1
&gt;&gt;doesnt.

&gt;&gt;If you use a pre-regulator, it is:

&gt;&gt;Iled = (Vprereg - Vled - Vk)/Rled

&gt;&gt;and, by definition (the regulator bit) Vprereg has no dependance on
&gt;&gt;Vout, so its partial derivative wrt Vout = zero - it looks like an AC
&gt;&gt;short circuit.

&gt;&gt;you then end up with:

&gt;&gt;Iled(s) = -Vout(s)*H(s)/Rled

&gt;&gt;which will go to zero whenever H(s) goes to zero.

&gt;&gt;HTH

&gt;&gt;Cheers
&gt;&gt;Terry- Dölj citerad text -

&gt;&gt;- Visa citerad text -

&gt; Ok, but I'm forced to use the pre-reg since the tl431 cannot withstand
&gt; this high secondary voltage.
&gt; I'm regulating somewhere around 100V.
&gt; But when you say that gain will always be &gt; 1 , in which frequency
&gt; does this apply?
">

read harder. it sounds like English is not your first language.

if you use a pre-regulator (you do) then that doesnt apply.

<QUOTE PREVIOUSPOST="
&gt; I try to have a closed loop response unity gain frequency of 3kHz,
&gt; since Fswitch is only 30kHz due to the slow IGBT devices used as main
&gt; switches.
">

just analyse the transfer function of your entire secondary circuit,
using much the same technique I illustrated above. Dont forget to
include the frequency response of the TL431 itself.....

or, post an ASCII drawing, and we'll help you do it.

Cheers
Terry
</POST>
<POST>
<POSTER> "Steve" &lt;stefan.toftev...@bredband.net&gt; </POSTER>
<POSTDATE> 2007-02-07T13:47:00 </POSTDATE>
On 7 Feb, 09:51, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

<QUOTE PREVIOUSPOST="
&gt; Steve wrote:
&gt; &gt; On 6 Feb, 21:58, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt; &gt;&gt;Steve wrote:

&gt; &gt;&gt;&gt;On 6 Feb, 11:16, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt; &gt;&gt;&gt;&gt;Steve wrote:

&gt; &gt;&gt;&gt;&gt;&gt;On 5 Feb, 16:35, &quot;Paul Mathews&quot; &lt;o ... @whidbey.com&gt; wrote:

&gt; &gt;&gt;&gt;&gt;&gt;&gt;On Feb 5, 2:48 am, &quot;Steve&quot; &lt;stefan.toftev ... @bredband.net&gt; wrote:

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;On 5 Feb, 08:58, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Eeyore wrote:

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Steve wrote:

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Hi once again,

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;I've find an optocoupler called TCET 1102 G.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;According to its datasheet, this coupler has an Fc of 110kHz.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Datasheet: http://www.dzsc.com/pdf_down.asp?id=642422

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;110kHz with a diode current of 10mA and a load resistance of 100 ohms. I suspect
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;you're unlikely to be using it like that.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Will this mean I may use it in my smps loop which has a unity gain
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;frequency of 3kHz.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;It won't have an Fc of 110kHz most likely under the conditions you're likely to
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;be using it I reckon.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Graham

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;wot he said. Its trivial to measure the -3dB frequency response of the
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;opto in your circuit; do so. That way you'll KNOW the phase shift the
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;opto introduces.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Conversely its astonishingly hard to measure the total loop response
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;unless you have a fancy wodgy. thats wy step responses are often used
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;(and why said wodgies exist).

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;you can also do this: run the smps from an isolated supply, and
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;completely bypass the opto. Do a step response, check its fine, then put
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;the opto back in and do it again. you'll pretty soon see if the opto
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;adds too much phase shift.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Cheers
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Terry- Dölj citerad text -

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;- Visa citerad text -

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;Though it seems like a good opto for this purpose?- Hide quoted text -

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;- Show quoted text -

&gt; &gt;&gt;&gt;&gt;&gt;&gt;Yes, although 100 kHz is about the usual fc for most optos operating
&gt; &gt;&gt;&gt;&gt;&gt;&gt;at around 1 mA LED bias and loaded on the phototransistor side such
&gt; &gt;&gt;&gt;&gt;&gt;&gt;that saturation is avoided. If you're connecting the LED anode to your
&gt; &gt;&gt;&gt;&gt;&gt;&gt;p.s. output without intermediate filtering, note that the frequency
&gt; &gt;&gt;&gt;&gt;&gt;&gt;characteristics of the circuit driving the cathode will not
&gt; &gt;&gt;&gt;&gt;&gt;&gt;necessarily dominate. For example, the classic TL431 integrator
&gt; &gt;&gt;&gt;&gt;&gt;&gt;driving the cathode can be understood to provide something like an AC
&gt; &gt;&gt;&gt;&gt;&gt;&gt;ground at the cathode at high frequencies, with the optocoupler then
&gt; &gt;&gt;&gt;&gt;&gt;&gt;coupling h.f. ripple on the LED anode directly to the output
&gt; &gt;&gt;&gt;&gt;&gt;&gt;phototransistor. The resulting midband rise in feedback has probably
&gt; &gt;&gt;&gt;&gt;&gt;&gt;saved more than a few designs and thrashed as many others.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;Paul Mathews- Dölj citerad text -

&gt; &gt;&gt;&gt;&gt;&gt;&gt;- Visa citerad text -

&gt; &gt;&gt;&gt;&gt;&gt;Ok
&gt; &gt;&gt;&gt;&gt;&gt;First I thought of using an op-amp with compensated feedback for
&gt; &gt;&gt;&gt;&gt;&gt;driving the led, but
&gt; &gt;&gt;&gt;&gt;&gt;since yesterday I'll try the TL431 instead.

&gt; &gt;&gt;&gt;&gt;it makes no difference if the LED is fed from the supply you are trying
&gt; &gt;&gt;&gt;&gt;to regulate.

&gt; &gt;&gt;&gt;&gt;&gt;The opto-coupler led anode will be coming right from one of the supply
&gt; &gt;&gt;&gt;&gt;&gt;lines, through dropping resistor / zenerdiode combination.
&gt; &gt;&gt;&gt;&gt;&gt;Across the zener there's a filter cap. This will bring noise down a
&gt; &gt;&gt;&gt;&gt;&gt;bit.
&gt; &gt;&gt;&gt;&gt;&gt;To the &quot;input&quot; of the TL431 there are a pole-zero network and across
&gt; &gt;&gt;&gt;&gt;&gt;the TL431 there's another pole-zero network and
&gt; &gt;&gt;&gt;&gt;&gt;one slope. There might come through some h.f ripple through the
&gt; &gt;&gt;&gt;&gt;&gt;compensation components across the 431.
&gt; &gt;&gt;&gt;&gt;&gt;This would surely also increase midband feedback / lowering the gain /
&gt; &gt;&gt;&gt;&gt;&gt;cause unwanted phase shift...     Oh dear.

&gt; &gt;&gt;&gt;&gt;what you have described should avoid the issue Paul mentioned.

&gt; &gt;&gt;&gt;&gt;When the opto LED circuit runs off the supply to be regulated, the
&gt; &gt;&gt;&gt;&gt;overall circuit gain is always &gt; 1 - draw a block diagram, its pretty
&gt; &gt;&gt;&gt;&gt;clear why. Even when the TL431 is a dead short, there is always the
&gt; &gt;&gt;&gt;&gt;direct path from supply thru led and series R.

&gt; &gt;&gt;&gt;&gt;with the zener pre-regulator and associated cap feeding the opto LED,
&gt; &gt;&gt;&gt;&gt;you effectively remove this path.

&gt; &gt;&gt;&gt;&gt;there is nothing &quot;wrong&quot; with either approach, you just need to
&gt; &gt;&gt;&gt;&gt;understand your loop before attempting to close it. As others mentioned,
&gt; &gt;&gt;&gt;&gt;most SMPS do this.

&gt; &gt;&gt;&gt;&gt;Cheers
&gt; &gt;&gt;&gt;&gt;Terry- Dölj citerad text -

&gt; &gt;&gt;&gt;&gt;- Visa citerad text -

&gt; &gt;&gt;&gt;Hello Terry.

&gt; &gt;&gt;&gt;I get your point of the gain &gt; 1 since the power to the led comes from
&gt; &gt;&gt;&gt;the same point as the
&gt; &gt;&gt;&gt;regulation does. If led power drops, the power will increase (since
&gt; &gt;&gt;&gt;led only will limit the pulsewidth)

&gt; &gt;&gt;just examine the maths, rather than hand-wavey arguments ;)

&gt; &gt;&gt;&gt;But I'm little confused of the difference in using a zener pre-reg.
&gt; &gt;&gt;&gt;I see it's a parallel path across the led, but........ hmmm

&gt; &gt;&gt;&gt;Most greatful for any additional comments,

&gt; &gt;&gt;&gt; Thanks!
&gt; &gt;&gt;&gt;Regards
&gt; &gt;&gt;&gt;Stefan

&gt; &gt;&gt;When you write an expression for LED current, it looks something like this:

&gt; &gt;&gt;Iled = (Vout - Vled - Vk)/Rled

&gt; &gt;&gt;Vk = (Vout - Vref)*H(s)

&gt; &gt;&gt;Vk = kathode voltage of TL431, ie the error amp output voltage (I've
&gt; &gt;&gt;carefully ignored the voltage divider here). H(s) = xfer function of
&gt; &gt;&gt;TL431 cct.

&gt; &gt;&gt;when you look at the small-signal response (perturb and toss out DC &amp;
&gt; &gt;&gt;high-order perturbation terms - IOW partial derivatives wrt Vout) Vled
&gt; &gt;&gt;disappears, as does Vref. You actually end up with:

&gt; &gt;&gt;Iled(s) = (Vout(s) - Vk(s))/Rled
&gt; &gt;&gt;            ^^^^^
&gt; &gt;&gt;            this is the key bit here

&gt; &gt;&gt;H(s) = -Zf(s)/Rtop

&gt; &gt;&gt;Zf(s) = impedance of TL431 feedback network

&gt; &gt;&gt;Rtop = top resistor in voltage divider; the bottom resistor always has a
&gt; &gt;&gt;constant voltage = Vref across it, due to the magic of -ve feedback, so
&gt; &gt;&gt;it falls out of the equation. if you thevenise the voltage divider and
&gt; &gt;&gt;do the sums, you will see this happen.

&gt; &gt;&gt;Vk(s) = Vout(s)*H(s)

&gt; &gt;&gt;so you get:

&gt; &gt;&gt;Iled(s) = [Vout(s) - Vout(s)*H(s)]/Rled

&gt; &gt;&gt;Iled(s) = Vout(s)[1-H(s)]/Rled

&gt; &gt;&gt;now you see where the 1 comes from. Even when H(s) goes to zero, the 1
&gt; &gt;&gt;doesnt.

&gt; &gt;&gt;If you use a pre-regulator, it is:

&gt; &gt;&gt;Iled = (Vprereg - Vled - Vk)/Rled

&gt; &gt;&gt;and, by definition (the regulator bit) Vprereg has no dependance on
&gt; &gt;&gt;Vout, so its partial derivative wrt Vout = zero - it looks like an AC
&gt; &gt;&gt;short circuit.

&gt; &gt;&gt;you then end up with:

&gt; &gt;&gt;Iled(s) = -Vout(s)*H(s)/Rled

&gt; &gt;&gt;which will go to zero whenever H(s) goes to zero.

&gt; &gt;&gt;HTH

&gt; &gt;&gt;Cheers
&gt; &gt;&gt;Terry- Dölj citerad text -

&gt; &gt;&gt;- Visa citerad text -

&gt; &gt; Ok, but I'm forced to use the pre-reg since the tl431 cannot withstand
&gt; &gt; this high secondary voltage.
&gt; &gt; I'm regulating somewhere around 100V.
&gt; &gt; But when you say that gain will always be &gt; 1 , in which frequency
&gt; &gt; does this apply?

&gt; read harder. it sounds like English is not your first language.

&gt; if you use a pre-regulator (you do) then that doesnt apply.

&gt; &gt; I try to have a closed loop response unity gain frequency of 3kHz,
&gt; &gt; since Fswitch is only 30kHz due to the slow IGBT devices used as main
&gt; &gt; switches.

&gt; just analyse the transfer function of your entire secondary circuit,
&gt; using much the same technique I illustrated above. Dont forget to
&gt; include the frequency response of the TL431 itself.....

&gt; or, post an ASCII drawing, and we'll help you do it.

&gt; Cheers
&gt; Terry- Dölj citerad text -

&gt; - Visa citerad text -
">

No, English is not my first language, you're right, but..........
no, never mind.

I'll read harder, and try to understand.

Thanks a lot for your assistance, I really appreciate it.

Regards
Stefan
</POST>
<POST>
<POSTER> Terry Given &lt;my_n...@ieee.org&gt; </POSTER>
<POSTDATE> 2007-02-07T15:49:00 </POSTDATE>
<QUOTE PREVIOUSPOST="
Steve wrote:
&gt; On 7 Feb, 09:51, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt;&gt;Steve wrote:

&gt;&gt;&gt;On 6 Feb, 21:58, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt;&gt;&gt;&gt;Steve wrote:

&gt;&gt;&gt;&gt;&gt;On 6 Feb, 11:16, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt;&gt;&gt;&gt;&gt;&gt;Steve wrote:

&gt;&gt;&gt;&gt;&gt;&gt;&gt;On 5 Feb, 16:35, &quot;Paul Mathews&quot; &lt;o ... @whidbey.com&gt; wrote:

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;On Feb 5, 2:48 am, &quot;Steve&quot; &lt;stefan.toftev ... @bredband.net&gt; wrote:

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;On 5 Feb, 08:58, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Eeyore wrote:

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Steve wrote:

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Hi once again,

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;I've find an optocoupler called TCET 1102 G.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;According to its datasheet, this coupler has an Fc of 110kHz.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Datasheet: http://www.dzsc.com/pdf_down.asp?id=642422

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;110kHz with a diode current of 10mA and a load resistance of 100 ohms. I suspect
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;you're unlikely to be using it like that.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Will this mean I may use it in my smps loop which has a unity gain
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;frequency of 3kHz.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;It won't have an Fc of 110kHz most likely under the conditions you're likely to
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;be using it I reckon.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Graham

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;wot he said. Its trivial to measure the -3dB frequency response of the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;opto in your circuit; do so. That way you'll KNOW the phase shift the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;opto introduces.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Conversely its astonishingly hard to measure the total loop response
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;unless you have a fancy wodgy. thats wy step responses are often used
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;(and why said wodgies exist).

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;you can also do this: run the smps from an isolated supply, and
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;completely bypass the opto. Do a step response, check its fine, then put
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;the opto back in and do it again. you'll pretty soon see if the opto
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;adds too much phase shift.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Cheers
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Terry- Dölj citerad text -

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;- Visa citerad text -

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Though it seems like a good opto for this purpose?- Hide quoted text -

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;- Show quoted text -

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Yes, although 100 kHz is about the usual fc for most optos operating
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;at around 1 mA LED bias and loaded on the phototransistor side such
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;that saturation is avoided. If you're connecting the LED anode to your
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;p.s. output without intermediate filtering, note that the frequency
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;characteristics of the circuit driving the cathode will not
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;necessarily dominate. For example, the classic TL431 integrator
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;driving the cathode can be understood to provide something like an AC
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;ground at the cathode at high frequencies, with the optocoupler then
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;coupling h.f. ripple on the LED anode directly to the output
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;phototransistor. The resulting midband rise in feedback has probably
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;saved more than a few designs and thrashed as many others.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Paul Mathews- Dölj citerad text -

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;- Visa citerad text -

&gt;&gt;&gt;&gt;&gt;&gt;&gt;Ok
&gt;&gt;&gt;&gt;&gt;&gt;&gt;First I thought of using an op-amp with compensated feedback for
&gt;&gt;&gt;&gt;&gt;&gt;&gt;driving the led, but
&gt;&gt;&gt;&gt;&gt;&gt;&gt;since yesterday I'll try the TL431 instead.

&gt;&gt;&gt;&gt;&gt;&gt;it makes no difference if the LED is fed from the supply you are trying
&gt;&gt;&gt;&gt;&gt;&gt;to regulate.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;The opto-coupler led anode will be coming right from one of the supply
&gt;&gt;&gt;&gt;&gt;&gt;&gt;lines, through dropping resistor / zenerdiode combination.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;Across the zener there's a filter cap. This will bring noise down a
&gt;&gt;&gt;&gt;&gt;&gt;&gt;bit.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;To the &quot;input&quot; of the TL431 there are a pole-zero network and across
&gt;&gt;&gt;&gt;&gt;&gt;&gt;the TL431 there's another pole-zero network and
&gt;&gt;&gt;&gt;&gt;&gt;&gt;one slope. There might come through some h.f ripple through the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;compensation components across the 431.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;This would surely also increase midband feedback / lowering the gain /
&gt;&gt;&gt;&gt;&gt;&gt;&gt;cause unwanted phase shift...     Oh dear.

&gt;&gt;&gt;&gt;&gt;&gt;what you have described should avoid the issue Paul mentioned.

&gt;&gt;&gt;&gt;&gt;&gt;When the opto LED circuit runs off the supply to be regulated, the
&gt;&gt;&gt;&gt;&gt;&gt;overall circuit gain is always &gt; 1 - draw a block diagram, its pretty
&gt;&gt;&gt;&gt;&gt;&gt;clear why. Even when the TL431 is a dead short, there is always the
&gt;&gt;&gt;&gt;&gt;&gt;direct path from supply thru led and series R.

&gt;&gt;&gt;&gt;&gt;&gt;with the zener pre-regulator and associated cap feeding the opto LED,
&gt;&gt;&gt;&gt;&gt;&gt;you effectively remove this path.

&gt;&gt;&gt;&gt;&gt;&gt;there is nothing &quot;wrong&quot; with either approach, you just need to
&gt;&gt;&gt;&gt;&gt;&gt;understand your loop before attempting to close it. As others mentioned,
&gt;&gt;&gt;&gt;&gt;&gt;most SMPS do this.

&gt;&gt;&gt;&gt;&gt;&gt;Cheers
&gt;&gt;&gt;&gt;&gt;&gt;Terry- Dölj citerad text -

&gt;&gt;&gt;&gt;&gt;&gt;- Visa citerad text -

&gt;&gt;&gt;&gt;&gt;Hello Terry.

&gt;&gt;&gt;&gt;&gt;I get your point of the gain &gt; 1 since the power to the led comes from
&gt;&gt;&gt;&gt;&gt;the same point as the
&gt;&gt;&gt;&gt;&gt;regulation does. If led power drops, the power will increase (since
&gt;&gt;&gt;&gt;&gt;led only will limit the pulsewidth)

&gt;&gt;&gt;&gt;just examine the maths, rather than hand-wavey arguments ;)

&gt;&gt;&gt;&gt;&gt;But I'm little confused of the difference in using a zener pre-reg.
&gt;&gt;&gt;&gt;&gt;I see it's a parallel path across the led, but........ hmmm

&gt;&gt;&gt;&gt;&gt;Most greatful for any additional comments,

&gt;&gt;&gt;&gt;&gt;Thanks!
&gt;&gt;&gt;&gt;&gt;Regards
&gt;&gt;&gt;&gt;&gt;Stefan

&gt;&gt;&gt;&gt;When you write an expression for LED current, it looks something like this:

&gt;&gt;&gt;&gt;Iled = (Vout - Vled - Vk)/Rled

&gt;&gt;&gt;&gt;Vk = (Vout - Vref)*H(s)

&gt;&gt;&gt;&gt;Vk = kathode voltage of TL431, ie the error amp output voltage (I've
&gt;&gt;&gt;&gt;carefully ignored the voltage divider here). H(s) = xfer function of
&gt;&gt;&gt;&gt;TL431 cct.

&gt;&gt;&gt;&gt;when you look at the small-signal response (perturb and toss out DC &amp;
&gt;&gt;&gt;&gt;high-order perturbation terms - IOW partial derivatives wrt Vout) Vled
&gt;&gt;&gt;&gt;disappears, as does Vref. You actually end up with:

&gt;&gt;&gt;&gt;Iled(s) = (Vout(s) - Vk(s))/Rled
&gt;&gt;&gt;&gt;           ^^^^^
&gt;&gt;&gt;&gt;           this is the key bit here

&gt;&gt;&gt;&gt;H(s) = -Zf(s)/Rtop

&gt;&gt;&gt;&gt;Zf(s) = impedance of TL431 feedback network

&gt;&gt;&gt;&gt;Rtop = top resistor in voltage divider; the bottom resistor always has a
&gt;&gt;&gt;&gt;constant voltage = Vref across it, due to the magic of -ve feedback, so
&gt;&gt;&gt;&gt;it falls out of the equation. if you thevenise the voltage divider and
&gt;&gt;&gt;&gt;do the sums, you will see this happen.

&gt;&gt;&gt;&gt;Vk(s) = Vout(s)*H(s)

&gt;&gt;&gt;&gt;so you get:

&gt;&gt;&gt;&gt;Iled(s) = [Vout(s) - Vout(s)*H(s)]/Rled

&gt;&gt;&gt;&gt;Iled(s) = Vout(s)[1-H(s)]/Rled

&gt;&gt;&gt;&gt;now you see where the 1 comes from. Even when H(s) goes to zero, the 1
&gt;&gt;&gt;&gt;doesnt.

&gt;&gt;&gt;&gt;If you use a pre-regulator, it is:

&gt;&gt;&gt;&gt;Iled = (Vprereg - Vled - Vk)/Rled

&gt;&gt;&gt;&gt;and, by definition (the regulator bit) Vprereg has no dependance on
&gt;&gt;&gt;&gt;Vout, so its partial derivative wrt Vout = zero - it looks like an AC
&gt;&gt;&gt;&gt;short circuit.

&gt;&gt;&gt;&gt;you then end up with:

&gt;&gt;&gt;&gt;Iled(s) = -Vout(s)*H(s)/Rled

&gt;&gt;&gt;&gt;which will go to zero whenever H(s) goes to zero.

&gt;&gt;&gt;&gt;HTH

&gt;&gt;&gt;&gt;Cheers
&gt;&gt;&gt;&gt;Terry- Dölj citerad text -

&gt;&gt;&gt;&gt;- Visa citerad text -

&gt;&gt;&gt;Ok, but I'm forced to use the pre-reg since the tl431 cannot withstand
&gt;&gt;&gt;this high secondary voltage.
&gt;&gt;&gt;I'm regulating somewhere around 100V.
&gt;&gt;&gt;But when you say that gain will always be &gt; 1 , in which frequency
&gt;&gt;&gt;does this apply?

&gt;&gt;read harder. it sounds like English is not your first language.

&gt;&gt;if you use a pre-regulator (you do) then that doesnt apply.

&gt;&gt;&gt;I try to have a closed loop response unity gain frequency of 3kHz,
&gt;&gt;&gt;since Fswitch is only 30kHz due to the slow IGBT devices used as main
&gt;&gt;&gt;switches.

&gt;&gt;just analyse the transfer function of your entire secondary circuit,
&gt;&gt;using much the same technique I illustrated above. Dont forget to
&gt;&gt;include the frequency response of the TL431 itself.....

&gt;&gt;or, post an ASCII drawing, and we'll help you do it.

&gt;&gt;Cheers
&gt;&gt;Terry- Dölj citerad text -

&gt;&gt;- Visa citerad text -

&gt; No, English is not my first language, you're right, but..........
&gt; no, never mind.
">

well done, I can only speak 1.5 languages. eventually I'll be able to
have a proper conversation in Mandarin, but it'll be a long time before
I can read a newspaper ;)

IOW I'm not giving you a hard time; reading comprehension is hard
enough, but ESL complicates things further.

<QUOTE PREVIOUSPOST="
&gt; I'll read harder, and try to understand.
">

the info is there. seeing as ou didnt quite get it, I'll re-phrase it.

try asking this question: what is the small-signal relationship between
the regulated output voltage and the opto LED current when you replace
the error amplifier (TL431) with a short to 0V, for both the
conventional (fed from Vout) and your pre-regulated circuit?

the answer is:

Iled = (Vout - Vled)/Rled for the conventional circuit

perturbing, the small signal relationship is

iled = vout/Rled IOW its directly proportional to Vout (this is the "1")

for your circuit:

Iled = (Vpre_reg - Vled)/Rled

small signal:

iled = 0

<QUOTE PREVIOUSPOST="
&gt; Thanks a lot for your assistance, I really appreciate it.

&gt; Regards
&gt; Stefan
">

no worries. you should have seen the number of fuck-ups I made in my
first SMPS. the best one of all was completely omitting the transfer
function of the TL431, which kinda explains why my calculations had no
bearing on my measured results. In the end I "tuned" the loop manually,
by looking at the step response and fiddling it :)

Cheers
Terry
</POST>
<POST>
<POSTER> "Steve" &lt;stefan.toftev...@bredband.net&gt; </POSTER>
<POSTDATE> 2007-02-08T00:30:00 </POSTDATE>
On 7 Feb, 21:49, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

<QUOTE PREVIOUSPOST="
&gt; Steve wrote:
&gt; &gt; On 7 Feb, 09:51, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt; &gt;&gt;Steve wrote:

&gt; &gt;&gt;&gt;On 6 Feb, 21:58, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt; &gt;&gt;&gt;&gt;Steve wrote:

&gt; &gt;&gt;&gt;&gt;&gt;On 6 Feb, 11:16, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt; &gt;&gt;&gt;&gt;&gt;&gt;Steve wrote:

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;On 5 Feb, 16:35, &quot;Paul Mathews&quot; &lt;o ... @whidbey.com&gt; wrote:

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;On Feb 5, 2:48 am, &quot;Steve&quot; &lt;stefan.toftev ... @bredband.net&gt; wrote:

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;On 5 Feb, 08:58, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Eeyore wrote:

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Steve wrote:

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Hi once again,

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;I've find an optocoupler called TCET 1102 G.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;According to its datasheet, this coupler has an Fc of 110kHz.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Datasheet: http://www.dzsc.com/pdf_down.asp?id=642422

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;110kHz with a diode current of 10mA and a load resistance of 100 ohms. I suspect
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;you're unlikely to be using it like that.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Will this mean I may use it in my smps loop which has a unity gain
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;frequency of 3kHz.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;It won't have an Fc of 110kHz most likely under the conditions you're likely to
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;be using it I reckon.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Graham

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;wot he said. Its trivial to measure the -3dB frequency response of the
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;opto in your circuit; do so. That way you'll KNOW the phase shift the
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;opto introduces.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Conversely its astonishingly hard to measure the total loop response
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;unless you have a fancy wodgy. thats wy step responses are often used
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;(and why said wodgies exist).

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;you can also do this: run the smps from an isolated supply, and
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;completely bypass the opto. Do a step response, check its fine, then put
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;the opto back in and do it again. you'll pretty soon see if the opto
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;adds too much phase shift.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Cheers
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Terry- Dölj citerad text -

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;- Visa citerad text -

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Though it seems like a good opto for this purpose?- Hide quoted text -

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;- Show quoted text -

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Yes, although 100 kHz is about the usual fc for most optos operating
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;at around 1 mA LED bias and loaded on the phototransistor side such
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;that saturation is avoided. If you're connecting the LED anode to your
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;p.s. output without intermediate filtering, note that the frequency
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;characteristics of the circuit driving the cathode will not
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;necessarily dominate. For example, the classic TL431 integrator
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;driving the cathode can be understood to provide something like an AC
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;ground at the cathode at high frequencies, with the optocoupler then
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;coupling h.f. ripple on the LED anode directly to the output
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;phototransistor. The resulting midband rise in feedback has probably
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;saved more than a few designs and thrashed as many others.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Paul Mathews- Dölj citerad text -

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;- Visa citerad text -

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;Ok
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;First I thought of using an op-amp with compensated feedback for
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;driving the led, but
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;since yesterday I'll try the TL431 instead.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;it makes no difference if the LED is fed from the supply you are trying
&gt; &gt;&gt;&gt;&gt;&gt;&gt;to regulate.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;The opto-coupler led anode will be coming right from one of the supply
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;lines, through dropping resistor / zenerdiode combination.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;Across the zener there's a filter cap. This will bring noise down a
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;bit.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;To the &quot;input&quot; of the TL431 there are a pole-zero network and across
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;the TL431 there's another pole-zero network and
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;one slope. There might come through some h.f ripple through the
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;compensation components across the 431.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;This would surely also increase midband feedback / lowering the gain /
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;cause unwanted phase shift...     Oh dear.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;what you have described should avoid the issue Paul mentioned.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;When the opto LED circuit runs off the supply to be regulated, the
&gt; &gt;&gt;&gt;&gt;&gt;&gt;overall circuit gain is always &gt; 1 - draw a block diagram, its pretty
&gt; &gt;&gt;&gt;&gt;&gt;&gt;clear why. Even when the TL431 is a dead short, there is always the
&gt; &gt;&gt;&gt;&gt;&gt;&gt;direct path from supply thru led and series R.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;with the zener pre-regulator and associated cap feeding the opto LED,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;you effectively remove this path.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;there is nothing &quot;wrong&quot; with either approach, you just need to
&gt; &gt;&gt;&gt;&gt;&gt;&gt;understand your loop before attempting to close it. As others mentioned,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;most SMPS do this.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;Cheers
&gt; &gt;&gt;&gt;&gt;&gt;&gt;Terry- Dölj citerad text -

&gt; &gt;&gt;&gt;&gt;&gt;&gt;- Visa citerad text -

&gt; &gt;&gt;&gt;&gt;&gt;Hello Terry.

&gt; &gt;&gt;&gt;&gt;&gt;I get your point of the gain &gt; 1 since the power to the led comes from
&gt; &gt;&gt;&gt;&gt;&gt;the same point as the
&gt; &gt;&gt;&gt;&gt;&gt;regulation does. If led power drops, the power will increase (since
&gt; &gt;&gt;&gt;&gt;&gt;led only will limit the pulsewidth)

&gt; &gt;&gt;&gt;&gt;just examine the maths, rather than hand-wavey arguments ;)

&gt; &gt;&gt;&gt;&gt;&gt;But I'm little confused of the difference in using a zener pre-reg.
&gt; &gt;&gt;&gt;&gt;&gt;I see it's a parallel path across the led, but........ hmmm

&gt; &gt;&gt;&gt;&gt;&gt;Most greatful for any additional comments,

&gt; &gt;&gt;&gt;&gt;&gt;Thanks!
&gt; &gt;&gt;&gt;&gt;&gt;Regards
&gt; &gt;&gt;&gt;&gt;&gt;Stefan

&gt; &gt;&gt;&gt;&gt;When you write an expression for LED current, it looks something like this:

&gt; &gt;&gt;&gt;&gt;Iled = (Vout - Vled - Vk)/Rled

&gt; &gt;&gt;&gt;&gt;Vk = (Vout - Vref)*H(s)

&gt; &gt;&gt;&gt;&gt;Vk = kathode voltage of TL431, ie the error amp output voltage (I've
&gt; &gt;&gt;&gt;&gt;carefully ignored the voltage divider here). H(s) = xfer function of
&gt; &gt;&gt;&gt;&gt;TL431 cct.

&gt; &gt;&gt;&gt;&gt;when you look at the small-signal response (perturb and toss out DC &amp;
&gt; &gt;&gt;&gt;&gt;high-order perturbation terms - IOW partial derivatives wrt Vout) Vled
&gt; &gt;&gt;&gt;&gt;disappears, as does Vref. You actually end up with:

&gt; &gt;&gt;&gt;&gt;Iled(s) = (Vout(s) - Vk(s))/Rled
&gt; &gt;&gt;&gt;&gt;           ^^^^^
&gt; &gt;&gt;&gt;&gt;           this is the key bit here

&gt; &gt;&gt;&gt;&gt;H(s) = -Zf(s)/Rtop

&gt; &gt;&gt;&gt;&gt;Zf(s) = impedance of TL431 feedback network

&gt; &gt;&gt;&gt;&gt;Rtop = top resistor in voltage divider; the bottom resistor always has a
&gt; &gt;&gt;&gt;&gt;constant voltage = Vref across it, due to the magic of -ve feedback, so
&gt; &gt;&gt;&gt;&gt;it falls out of the equation. if you thevenise the voltage divider and
&gt; &gt;&gt;&gt;&gt;do the sums, you will see this happen.

&gt; &gt;&gt;&gt;&gt;Vk(s) = Vout(s)*H(s)

&gt; &gt;&gt;&gt;&gt;so you get:

&gt; &gt;&gt;&gt;&gt;Iled(s) = [Vout(s) - Vout(s)*H(s)]/Rled

&gt; &gt;&gt;&gt;&gt;Iled(s) = Vout(s)[1-H(s)]/Rled

&gt; &gt;&gt;&gt;&gt;now you see where the 1 comes from. Even when H(s) goes to zero, the 1
&gt; &gt;&gt;&gt;&gt;doesnt.

&gt; &gt;&gt;&gt;&gt;If you use a pre-regulator, it is:

&gt; &gt;&gt;&gt;&gt;Iled = (Vprereg - Vled - Vk)/Rled

&gt; &gt;&gt;&gt;&gt;and, by definition (the regulator bit) Vprereg has no dependance on
&gt; &gt;&gt;&gt;&gt;Vout, so its partial derivative wrt Vout = zero - it looks like an AC
&gt; &gt;&gt;&gt;&gt;short circuit.

&gt; &gt;&gt;&gt;&gt;you then end up with:

&gt; &gt;&gt;&gt;&gt;Iled(s) = -Vout(s)*H(s)/Rled

&gt; &gt;&gt;&gt;&gt;which will go to zero whenever H(s) goes to zero.

&gt; &gt;&gt;&gt;&gt;HTH

&gt; &gt;&gt;&gt;&gt;Cheers
&gt; &gt;&gt;&gt;&gt;Terry- Dölj citerad text -

&gt; &gt;&gt;&gt;&gt;- Visa citerad text -

&gt; &gt;&gt;&gt;Ok, but I'm forced to use the pre-reg since the tl431 cannot withstand
&gt; &gt;&gt;&gt;this high secondary voltage.
&gt; &gt;&gt;&gt;I'm regulating somewhere around 100V.
&gt; &gt;&gt;&gt;But when you say that gain will always be &gt; 1 , in which frequency
&gt; &gt;&gt;&gt;does this apply?

&gt; &gt;&gt;read harder. it sounds like English is not your first language.

&gt; &gt;&gt;if you use a pre-regulator (you do) then that doesnt apply.

&gt; &gt;&gt;&gt;I try to have a closed loop response unity gain frequency of 3kHz,
&gt; &gt;&gt;&gt;since Fswitch is only 30kHz due to the slow IGBT devices used as main
&gt; &gt;&gt;&gt;switches.

&gt; &gt;&gt;just analyse the transfer function of your entire secondary circuit,
&gt; &gt;&gt;using much the same technique I illustrated above. Dont forget to
&gt; &gt;&gt;include the frequency response of the TL431 itself.....

&gt; &gt;&gt;or, post an ASCII drawing, and we'll help you do it.

&gt; &gt;&gt;Cheers
&gt; &gt;&gt;Terry- Dölj citerad text -

&gt; &gt;&gt;- Visa citerad text -

&gt; &gt; No, English is not my first language, you're right, but..........
&gt; &gt; no, never mind.

&gt; well done, I can only speak 1.5 languages. eventually I'll be able to
&gt; have a proper conversation in Mandarin, but it'll be a long time before
&gt; I can read a newspaper ;)

&gt; IOW I'm not giving you a hard time; reading comprehension is hard
&gt; enough, but ESL complicates things further.

&gt; &gt; I'll read harder, and try to understand.

&gt; the info is there. seeing as ou didnt quite get it, I'll re-phrase it.

&gt; try asking this question: what is the small-signal relationship between
&gt; the regulated output voltage and the opto LED current when you replace
&gt; the error amplifier (TL431) with a short to 0V, for both the
&gt; conventional (fed from Vout) and your pre-regulated circuit?

&gt; the answer is:

&gt; Iled = (Vout - Vled)/Rled for the conventional circuit

&gt; perturbing, the small signal relationship is

&gt; iled = vout/Rled IOW its directly proportional to Vout (this is the &quot;1&quot;)

&gt; for your circuit:

&gt; Iled = (Vpre_reg - Vled)/Rled

&gt; small signal:

&gt; iled = 0

&gt; &gt; Thanks a lot for your assistance, I really appreciate it.

&gt; &gt; Regards
&gt; &gt; Stefan

&gt; no worries. you should have seen the number of fuck-ups I made in my
&gt; first SMPS. the best one of all was completely omitting the transfer
&gt; function of the TL431, which kinda explains why my calculations had no
&gt; bearing on my measured results. In the end I &quot;tuned&quot; the loop manually,
&gt; by looking at the step response and fiddling it :)

&gt; Cheers
&gt; Terry- Dölj citerad text -

&gt; - Visa citerad text -
">

If you have the time to look at it, I may upload a schematic of the
entire loop including
power circuit gain and compensation bits.
</POST>
<POST>
<POSTER> Eeyore &lt;rabbitsfriendsandrelati...@hotmail.com&gt; </POSTER>
<POSTDATE> 2007-02-08T00:48:00 </POSTDATE>
<QUOTE PREVIOUSPOST="
Steve wrote:
&gt; If you have the time to look at it, I may upload a schematic of the
&gt; entire loop including power circuit gain and compensation bits.
">

You can't post binaries (attachments) here but if you can get access to
alt.binaries.schematics.electronics that's the ideal place for it. Or put on it one of those free
picture sharing sites.

Graham
</POST>
<POST>
<POSTER> "Steve" &lt;stefan.toftev...@bredband.net&gt; </POSTER>
<POSTDATE> 2007-02-08T01:40:00 </POSTDATE>
On 8 Feb, 06:48, Eeyore &lt;rabbitsfriendsandrelati ... @hotmail.com&gt;
wrote:

<QUOTE PREVIOUSPOST="
&gt; Steve wrote:
&gt; &gt; If you have the time to look at it, I may upload a schematic of the
&gt; &gt; entire loop including power circuit gain and compensation bits.

&gt; You can't post binaries (attachments) here but if you can get access to
&gt; alt.binaries.schematics.electronics that's the ideal place for it. Or put on it one of those free
&gt; picture sharing sites.

&gt; Graham
">

I've got some own webspace so that's not a problem
</POST>
<POST>
<POSTER> Terry Given &lt;my_n...@ieee.org&gt; </POSTER>
<POSTDATE> 2007-02-08T03:39:00 </POSTDATE>
<QUOTE PREVIOUSPOST="
Steve wrote:
&gt; On 7 Feb, 21:49, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt;&gt;Steve wrote:

&gt;&gt;&gt;On 7 Feb, 09:51, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt;&gt;&gt;&gt;Steve wrote:

&gt;&gt;&gt;&gt;&gt;On 6 Feb, 21:58, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt;&gt;&gt;&gt;&gt;&gt;Steve wrote:

&gt;&gt;&gt;&gt;&gt;&gt;&gt;On 6 Feb, 11:16, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Steve wrote:

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;On 5 Feb, 16:35, &quot;Paul Mathews&quot; &lt;o ... @whidbey.com&gt; wrote:

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;On Feb 5, 2:48 am, &quot;Steve&quot; &lt;stefan.toftev ... @bredband.net&gt; wrote:

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;On 5 Feb, 08:58, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Eeyore wrote:

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Steve wrote:

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Hi once again,

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;I've find an optocoupler called TCET 1102 G.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;According to its datasheet, this coupler has an Fc of 110kHz.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Datasheet: http://www.dzsc.com/pdf_down.asp?id=642422

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;110kHz with a diode current of 10mA and a load resistance of 100 ohms. I suspect
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;you're unlikely to be using it like that.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Will this mean I may use it in my smps loop which has a unity gain
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;frequency of 3kHz.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;It won't have an Fc of 110kHz most likely under the conditions you're likely to
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;be using it I reckon.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Graham

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;wot he said. Its trivial to measure the -3dB frequency response of the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;opto in your circuit; do so. That way you'll KNOW the phase shift the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;opto introduces.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Conversely its astonishingly hard to measure the total loop response
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;unless you have a fancy wodgy. thats wy step responses are often used
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;(and why said wodgies exist).

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;you can also do this: run the smps from an isolated supply, and
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;completely bypass the opto. Do a step response, check its fine, then put
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;the opto back in and do it again. you'll pretty soon see if the opto
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;adds too much phase shift.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Cheers
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Terry- Dölj citerad text -

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;- Visa citerad text -

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Though it seems like a good opto for this purpose?- Hide quoted text -

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;- Show quoted text -

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Yes, although 100 kHz is about the usual fc for most optos operating
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;at around 1 mA LED bias and loaded on the phototransistor side such
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;that saturation is avoided. If you're connecting the LED anode to your
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;p.s. output without intermediate filtering, note that the frequency
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;characteristics of the circuit driving the cathode will not
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;necessarily dominate. For example, the classic TL431 integrator
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;driving the cathode can be understood to provide something like an AC
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;ground at the cathode at high frequencies, with the optocoupler then
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;coupling h.f. ripple on the LED anode directly to the output
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;phototransistor. The resulting midband rise in feedback has probably
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;saved more than a few designs and thrashed as many others.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Paul Mathews- Dölj citerad text -

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;- Visa citerad text -

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Ok
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;First I thought of using an op-amp with compensated feedback for
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;driving the led, but
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;since yesterday I'll try the TL431 instead.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;it makes no difference if the LED is fed from the supply you are trying
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;to regulate.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;The opto-coupler led anode will be coming right from one of the supply
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;lines, through dropping resistor / zenerdiode combination.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Across the zener there's a filter cap. This will bring noise down a
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;bit.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;To the &quot;input&quot; of the TL431 there are a pole-zero network and across
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;the TL431 there's another pole-zero network and
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;one slope. There might come through some h.f ripple through the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;compensation components across the 431.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;This would surely also increase midband feedback / lowering the gain /
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;cause unwanted phase shift...     Oh dear.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;what you have described should avoid the issue Paul mentioned.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;When the opto LED circuit runs off the supply to be regulated, the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;overall circuit gain is always &gt; 1 - draw a block diagram, its pretty
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;clear why. Even when the TL431 is a dead short, there is always the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;direct path from supply thru led and series R.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;with the zener pre-regulator and associated cap feeding the opto LED,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;you effectively remove this path.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;there is nothing &quot;wrong&quot; with either approach, you just need to
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;understand your loop before attempting to close it. As others mentioned,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;most SMPS do this.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Cheers
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Terry- Dölj citerad text -

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;- Visa citerad text -

&gt;&gt;&gt;&gt;&gt;&gt;&gt;Hello Terry.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;I get your point of the gain &gt; 1 since the power to the led comes from
&gt;&gt;&gt;&gt;&gt;&gt;&gt;the same point as the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;regulation does. If led power drops, the power will increase (since
&gt;&gt;&gt;&gt;&gt;&gt;&gt;led only will limit the pulsewidth)

&gt;&gt;&gt;&gt;&gt;&gt;just examine the maths, rather than hand-wavey arguments ;)

&gt;&gt;&gt;&gt;&gt;&gt;&gt;But I'm little confused of the difference in using a zener pre-reg.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;I see it's a parallel path across the led, but........ hmmm

&gt;&gt;&gt;&gt;&gt;&gt;&gt;Most greatful for any additional comments,

&gt;&gt;&gt;&gt;&gt;&gt;&gt;Thanks!
&gt;&gt;&gt;&gt;&gt;&gt;&gt;Regards
&gt;&gt;&gt;&gt;&gt;&gt;&gt;Stefan

&gt;&gt;&gt;&gt;&gt;&gt;When you write an expression for LED current, it looks something like this:

&gt;&gt;&gt;&gt;&gt;&gt;Iled = (Vout - Vled - Vk)/Rled

&gt;&gt;&gt;&gt;&gt;&gt;Vk = (Vout - Vref)*H(s)

&gt;&gt;&gt;&gt;&gt;&gt;Vk = kathode voltage of TL431, ie the error amp output voltage (I've
&gt;&gt;&gt;&gt;&gt;&gt;carefully ignored the voltage divider here). H(s) = xfer function of
&gt;&gt;&gt;&gt;&gt;&gt;TL431 cct.

&gt;&gt;&gt;&gt;&gt;&gt;when you look at the small-signal response (perturb and toss out DC &amp;
&gt;&gt;&gt;&gt;&gt;&gt;high-order perturbation terms - IOW partial derivatives wrt Vout) Vled
&gt;&gt;&gt;&gt;&gt;&gt;disappears, as does Vref. You actually end up with:

&gt;&gt;&gt;&gt;&gt;&gt;Iled(s) = (Vout(s) - Vk(s))/Rled
&gt;&gt;&gt;&gt;&gt;&gt;          ^^^^^
&gt;&gt;&gt;&gt;&gt;&gt;          this is the key bit here

&gt;&gt;&gt;&gt;&gt;&gt;H(s) = -Zf(s)/Rtop

&gt;&gt;&gt;&gt;&gt;&gt;Zf(s) = impedance of TL431 feedback network

&gt;&gt;&gt;&gt;&gt;&gt;Rtop = top resistor in voltage divider; the bottom resistor always has a
&gt;&gt;&gt;&gt;&gt;&gt;constant voltage = Vref across it, due to the magic of -ve feedback, so
&gt;&gt;&gt;&gt;&gt;&gt;it falls out of the equation. if you thevenise the voltage divider and
&gt;&gt;&gt;&gt;&gt;&gt;do the sums, you will see this happen.

&gt;&gt;&gt;&gt;&gt;&gt;Vk(s) = Vout(s)*H(s)

&gt;&gt;&gt;&gt;&gt;&gt;so you get:

&gt;&gt;&gt;&gt;&gt;&gt;Iled(s) = [Vout(s) - Vout(s)*H(s)]/Rled

&gt;&gt;&gt;&gt;&gt;&gt;Iled(s) = Vout(s)[1-H(s)]/Rled

&gt;&gt;&gt;&gt;&gt;&gt;now you see where the 1 comes from. Even when H(s) goes to zero, the 1
&gt;&gt;&gt;&gt;&gt;&gt;doesnt.

&gt;&gt;&gt;&gt;&gt;&gt;If you use a pre-regulator, it is:

&gt;&gt;&gt;&gt;&gt;&gt;Iled = (Vprereg - Vled - Vk)/Rled

&gt;&gt;&gt;&gt;&gt;&gt;and, by definition (the regulator bit) Vprereg has no dependance on
&gt;&gt;&gt;&gt;&gt;&gt;Vout, so its partial derivative wrt Vout = zero - it looks like an AC
&gt;&gt;&gt;&gt;&gt;&gt;short circuit.

&gt;&gt;&gt;&gt;&gt;&gt;you then end up with:

&gt;&gt;&gt;&gt;&gt;&gt;Iled(s) = -Vout(s)*H(s)/Rled

&gt;&gt;&gt;&gt;&gt;&gt;which will go to zero whenever H(s) goes to zero.

&gt;&gt;&gt;&gt;&gt;&gt;HTH

&gt;&gt;&gt;&gt;&gt;&gt;Cheers
&gt;&gt;&gt;&gt;&gt;&gt;Terry- Dölj citerad text -

&gt;&gt;&gt;&gt;&gt;&gt;- Visa citerad text -

&gt;&gt;&gt;&gt;&gt;Ok, but I'm forced to use the pre-reg since the tl431 cannot withstand
&gt;&gt;&gt;&gt;&gt;this high secondary voltage.
&gt;&gt;&gt;&gt;&gt;I'm regulating somewhere around 100V.
&gt;&gt;&gt;&gt;&gt;But when you say that gain will always be &gt; 1 , in which frequency
&gt;&gt;&gt;&gt;&gt;does this apply?

&gt;&gt;&gt;&gt;read harder. it sounds like English is not your first language.

&gt;&gt;&gt;&gt;if you use a pre-regulator (you do) then that doesnt apply.

&gt;&gt;&gt;&gt;&gt;I try to have a closed loop response unity gain frequency of 3kHz,
&gt;&gt;&gt;&gt;&gt;since Fswitch is only 30kHz due to the slow IGBT devices used as main
&gt;&gt;&gt;&gt;&gt;switches.

&gt;&gt;&gt;&gt;just analyse the transfer function of your entire secondary circuit,
&gt;&gt;&gt;&gt;using much the same technique I illustrated above. Dont forget to
&gt;&gt;&gt;&gt;include the frequency response of the TL431 itself.....

&gt;&gt;&gt;&gt;or, post an ASCII drawing, and we'll help you do it.

&gt;&gt;&gt;&gt;Cheers
&gt;&gt;&gt;&gt;Terry- Dölj citerad text -

&gt;&gt;&gt;&gt;- Visa citerad text -

&gt;&gt;&gt;No, English is not my first language, you're right, but..........
&gt;&gt;&gt;no, never mind.

&gt;&gt;well done, I can only speak 1.5 languages. eventually I'll be able to
&gt;&gt;have a proper conversation in Mandarin, but it'll be a long time before
&gt;&gt;I can read a newspaper ;)

&gt;&gt;IOW I'm not giving you a hard time; reading comprehension is hard
&gt;&gt;enough, but ESL complicates things further.

&gt;&gt;&gt;I'll read harder, and try to understand.

&gt;&gt;the info is there. seeing as ou didnt quite get it, I'll re-phrase it.

&gt;&gt;try asking this question: what is the small-signal relationship between
&gt;&gt;the regulated output voltage and the opto LED current when you replace
&gt;&gt;the error amplifier (TL431) with a short to 0V, for both the
&gt;&gt;conventional (fed from Vout) and your pre-regulated circuit?

&gt;&gt;the answer is:

&gt;&gt;Iled = (Vout - Vled)/Rled for the conventional circuit

&gt;&gt;perturbing, the small signal relationship is

&gt;&gt;iled = vout/Rled IOW its directly proportional to Vout (this is the &quot;1&quot;)

&gt;&gt;for your circuit:

&gt;&gt;Iled = (Vpre_reg - Vled)/Rled

&gt;&gt;small signal:

&gt;&gt;iled = 0

&gt;&gt;&gt;Thanks a lot for your assistance, I really appreciate it.

&gt;&gt;&gt;Regards
&gt;&gt;&gt;Stefan

&gt;&gt;no worries. you should have seen the number of fuck-ups I made in my
&gt;&gt;first SMPS. the best one of all was completely omitting the transfer
&gt;&gt;function of the TL431, which kinda explains why my calculations had no
&gt;&gt;bearing on my measured results. In the end I &quot;tuned&quot; the loop manually,
&gt;&gt;by looking at the step response and fiddling it :)

&gt;&gt;Cheers
&gt;&gt;Terry- Dölj citerad text -

&gt;&gt;- Visa citerad text -

&gt; If you have the time to look at it, I may upload a schematic of the
&gt; entire loop including
&gt; power circuit gain and compensation bits.
">

can you email it to me? my crappy ISP wont let me see ABSE, and Im way
too lazy to figure out any other way of doing it. you can deduce my
email from the post :)

Cheers
Terry
</POST>
<POST>
<POSTER> Terry Given &lt;my_n...@ieee.org&gt; </POSTER>
<POSTDATE> 2007-02-08T03:40:00 </POSTDATE>
<QUOTE PREVIOUSPOST="
Steve wrote:
&gt; On 8 Feb, 06:48, Eeyore &lt;rabbitsfriendsandrelati ... @hotmail.com&gt;
&gt; wrote:

&gt;&gt;Steve wrote:

&gt;&gt;&gt;If you have the time to look at it, I may upload a schematic of the
&gt;&gt;&gt;entire loop including power circuit gain and compensation bits.

&gt;&gt;You can't post binaries (attachments) here but if you can get access to
&gt;&gt;alt.binaries.schematics.electronics that's the ideal place for it. Or put on it one of those free
&gt;&gt;picture sharing sites.

&gt;&gt;Graham

&gt; I've got some own webspace so that's not a problem
">

thats even better. ignore my previous post then.

Cheers
Terry
</POST>
<POST>
<POSTER> Rich Grise &lt;r...@example.net&gt; </POSTER>
<POSTDATE> 2007-02-08T12:27:00 </POSTDATE>
<QUOTE PREVIOUSPOST="
On Thu, 08 Feb 2007 05:48:28 +0000, Eeyore wrote:
&gt; Steve wrote:

&gt;&gt; If you have the time to look at it, I may upload a schematic of the
&gt;&gt; entire loop including power circuit gain and compensation bits.

&gt; You can't post binaries (attachments) here but if you can get access to
&gt; alt.binaries.schematics.electronics that's the ideal place for it. Or put on it one of those free
&gt; picture sharing sites.
">

I have not yet met an ISP who doesn't provide a web page for each of
their customers. Somewhere on their home page, they should have
instructions on how to reach it by FTP, and so on.

I'm not using mine, because I've already got so many. You might try
Tripod, or Lycos, or Geocities, which has come to be known as Geoshitties,
but I'm sure you get the point.

Cheers!
Rich
</POST>
<POST>
<POSTER> Eeyore &lt;rabbitsfriendsandrelati...@hotmail.com&gt; </POSTER>
<POSTDATE> 2007-02-08T13:24:00 </POSTDATE>
<QUOTE PREVIOUSPOST="
Rich Grise wrote:
&gt; I have not yet met an ISP who doesn't provide a web page for each of
&gt; their customers.
">

My current ISP doesn't. They just provide first class connectivity and a mail server.

Graham
</POST>
<POST>
<POSTER> "Henry Kiefer" &lt;otc_fri...@gmx.net&gt; </POSTER>
<POSTDATE> 2007-02-08T14:50:00 </POSTDATE>
"Eeyore" &lt;rabbitsfriendsandrelati ... @hotmail.com&gt; schrieb im Newsbeitrag news:45CB6ADA.A6C5494D@hotmail.com ...
|
|

<QUOTE PREVIOUSPOST="
| Rich Grise wrote:
">

|
| &gt; I have not yet met an ISP who doesn't provide a web page for each of
| &gt; their customers.
|
| My current ISP doesn't. They just provide first class connectivity and a mail server.

If it is true first class connectivity, then you can run your own server at home.

- Henry

--
www.ehydra.dyndns.info
</POST>
<POST>
<POSTER> Eeyore &lt;rabbitsfriendsandrelati...@hotmail.com&gt; </POSTER>
<POSTDATE> 2007-02-08T15:11:00 </POSTDATE>
<QUOTE PREVIOUSPOST="
Henry Kiefer wrote:
&gt; &quot;Eeyore&quot; &lt;rabbitsfriendsandrelati ... @hotmail.com&gt; schrieb im Newsbeitrag
&gt; | Rich Grise wrote:
&gt; |
&gt; | &gt; I have not yet met an ISP who doesn't provide a web page for each of
&gt; | &gt; their customers.
&gt; |
&gt; | My current ISP doesn't. They just provide first class connectivity and a mail server.

&gt; If it is true first class connectivity, then you can run your own server at home.
">

You can but it's far simpler ( for the time being at least ) to use theirs.

Graham
</POST>
<POST>
<POSTER> "Steve" &lt;stefan.toftev...@bredband.net&gt; </POSTER>
<POSTDATE> 2007-02-08T15:13:00 </POSTDATE>
On 8 Feb, 09:40, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

<QUOTE PREVIOUSPOST="
&gt; Steve wrote:
&gt; &gt; On 8 Feb, 06:48, Eeyore &lt;rabbitsfriendsandrelati ... @hotmail.com&gt;
&gt; &gt; wrote:

&gt; &gt;&gt;Steve wrote:

&gt; &gt;&gt;&gt;If you have the time to look at it, I may upload a schematic of the
&gt; &gt;&gt;&gt;entire loop including power circuit gain and compensation bits.

&gt; &gt;&gt;You can't post binaries (attachments) here but if you can get access to
&gt; &gt;&gt;alt.binaries.schematics.electronics that's the ideal place for it. Or put on it one of those free
&gt; &gt;&gt;picture sharing sites.

&gt; &gt;&gt;Graham

&gt; &gt; I've got some own webspace so that's not a problem

&gt; thats even better. ignore my previous post then.

&gt; Cheers
&gt; Terry- Dölj citerad text -

&gt; - Visa citerad text -
">

Hi Terry!

http://www.etanoldax.se/smps1.JPG

This link will bring you a very simplified circuit diagram made in
pure windows paint (!!)
It will give you information about power circuit gain and compensation
bits included in the loop.
My aim was to include a "double zero" at filter resonance to cancel
the phase shift caused by the LC filter.
The filter has a resonance frequency of 125Hz, I put a double zero at
153Hz.
Unfortunately I'm unaware of the ESR in the output caps. I noticed, if
it's between 50-100 mOhms, a very nice zero is introduced
which make things even better.
As I mentioned, I aim for a loop response unity gain frequency of
3kHz.
I'll be most greatful if you go through my circuit step by step to
determine loop compensation stuff.
This will be very teaching for me!

I appreciate your time and kindness in learning me this tricky things!

Regards
Stefan
</POST>
<POST>
<POSTER> krw &lt;k...@att.bizzzz&gt; </POSTER>
<POSTDATE> 2007-02-08T15:37:00 </POSTDATE>
In article &lt;45CB83F9.B6831 ... @hotmail.com&gt;,
rabbitsfriendsandrelati ... @hotmail.com says...

<QUOTE PREVIOUSPOST="
&gt; Henry Kiefer wrote:

&gt; &gt; &quot;Eeyore&quot; &lt;rabbitsfriendsandrelati ... @hotmail.com&gt; schrieb im Newsbeitrag
&gt; &gt; | Rich Grise wrote:
&gt; &gt; |
&gt; &gt; | &gt; I have not yet met an ISP who doesn't provide a web page for each of
&gt; &gt; | &gt; their customers.
&gt; &gt; |
&gt; &gt; | My current ISP doesn't. They just provide first class connectivity and a mail server.

&gt; &gt; If it is true first class connectivity, then you can run your own server at home.

&gt; You can but it's far simpler ( for the time being at least ) to use theirs.
">

Dumb donkey, you just said they didn't support user web pages.
Sheesh!

--
Keith
</POST>
<POST>
<POSTER> Eeyore &lt;rabbitsfriendsandrelati...@hotmail.com&gt; </POSTER>
<POSTDATE> 2007-02-08T21:21:00 </POSTDATE>
<QUOTE PREVIOUSPOST="
krw wrote:
&gt; rabbitsfriendsandrelati ... @hotmail.com says...
&gt; &gt; Henry Kiefer wrote:
&gt; &gt; &gt; &quot;Eeyore&quot; &lt;rabbitsfriendsandrelati ... @hotmail.com&gt; schrieb im Newsbeitrag
&gt; &gt; &gt; | Rich Grise wrote:
&gt; &gt; &gt; |
&gt; &gt; &gt; | &gt; I have not yet met an ISP who doesn't provide a web page for each of
&gt; &gt; &gt; | &gt; their customers.
&gt; &gt; &gt; |
&gt; &gt; &gt; | My current ISP doesn't. They just provide first class connectivity and a mail server.

&gt; &gt; &gt; If it is true first class connectivity, then you can run your own server at home.

&gt; &gt; You can but it's far simpler ( for the time being at least ) to use theirs.

&gt; Dumb donkey, you just said they didn't support user web pages.
&gt; Sheesh!
">

Since when is a mail server anything to do with use webspace ?

Graham
</POST>
<POST>
<POSTER> Andrew Edge &lt;a_n_d_y_e_d_...@mswsystems.com&gt; </POSTER>
<POSTDATE> 2007-02-09T04:34:00 </POSTDATE>
On 8 Feb 2007 12:13:43 -0800, "Steve" &lt;stefan.toftev ... @bredband.net&gt;
wrote:

<QUOTE PREVIOUSPOST="
&gt;On 8 Feb, 09:40, Terry Given &lt;my_n ... @ieee.org&gt; wrote:
&gt;&gt; Steve wrote:
&gt;&gt; &gt; On 8 Feb, 06:48, Eeyore &lt;rabbitsfriendsandrelati ... @hotmail.com&gt;
&gt;&gt; &gt; wrote:

&gt;&gt; &gt;&gt;Steve wrote:

&gt;&gt; &gt;&gt;&gt;If you have the time to look at it, I may upload a schematic of the
&gt;&gt; &gt;&gt;&gt;entire loop including power circuit gain and compensation bits.

&gt;&gt; &gt;&gt;You can't post binaries (attachments) here but if you can get access to
&gt;&gt; &gt;&gt;alt.binaries.schematics.electronics that's the ideal place for it. Or put on it one of those free
&gt;&gt; &gt;&gt;picture sharing sites.

&gt;&gt; &gt;&gt;Graham

&gt;&gt; &gt; I've got some own webspace so that's not a problem

&gt;&gt; thats even better. ignore my previous post then.

&gt;&gt; Cheers
&gt;&gt; Terry- Dölj citerad text -

&gt;&gt; - Visa citerad text -

&gt;Hi Terry!

&gt; http://www.etanoldax.se/smps1.JPG

&gt;This link will bring you a very simplified circuit diagram made in
&gt;pure windows paint (!!)
&gt;It will give you information about power circuit gain and compensation
&gt;bits included in the loop.
&gt;My aim was to include a &quot;double zero&quot; at filter resonance to cancel
&gt;the phase shift caused by the LC filter.
&gt;The filter has a resonance frequency of 125Hz, I put a double zero at
&gt;153Hz.
&gt;Unfortunately I'm unaware of the ESR in the output caps. I noticed, if
&gt;it's between 50-100 mOhms, a very nice zero is introduced
&gt;which make things even better.
&gt;As I mentioned, I aim for a loop response unity gain frequency of
&gt;3kHz.
&gt;I'll be most greatful if you go through my circuit step by step to
&gt;determine loop compensation stuff.
&gt;This will be very teaching for me!

&gt;I appreciate your time and kindness in learning me this tricky things!

&gt;Regards
&gt;Stefan
">

Hi .
To be a real help we need all the values of the components.
They are some component values that are missing. Resistors, capacitors
and looks like a zener .

Andy
</POST>
<POST>
<POSTER> Terry Given &lt;my_n...@ieee.org&gt; </POSTER>
<POSTDATE> 2007-02-09T06:23:00 </POSTDATE>
<QUOTE PREVIOUSPOST="
Andrew Edge wrote:
&gt; On 8 Feb 2007 12:13:43 -0800, &quot;Steve&quot; &lt;stefan.toftev ... @bredband.net&gt;
&gt; wrote:

&gt;&gt;On 8 Feb, 09:40, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt;&gt;&gt;Steve wrote:

&gt;&gt;&gt;&gt;On 8 Feb, 06:48, Eeyore &lt;rabbitsfriendsandrelati ... @hotmail.com&gt;
&gt;&gt;&gt;&gt;wrote:

&gt;&gt;&gt;&gt;&gt;Steve wrote:

&gt;&gt;&gt;&gt;&gt;&gt;If you have the time to look at it, I may upload a schematic of the
&gt;&gt;&gt;&gt;&gt;&gt;entire loop including power circuit gain and compensation bits.

&gt;&gt;&gt;&gt;&gt;You can't post binaries (attachments) here but if you can get access to
&gt;&gt;&gt;&gt;&gt;alt.binaries.schematics.electronics that's the ideal place for it. Or put on it one of those free
&gt;&gt;&gt;&gt;&gt;picture sharing sites.

&gt;&gt;&gt;&gt;&gt;Graham

&gt;&gt;&gt;&gt;I've got some own webspace so that's not a problem

&gt;&gt;&gt;thats even better. ignore my previous post then.

&gt;&gt;&gt;Cheers
&gt;&gt;&gt;Terry- Dölj citerad text -

&gt;&gt;&gt;- Visa citerad text -

&gt;&gt;Hi Terry!

&gt;&gt; http://www.etanoldax.se/smps1.JPG

&gt;&gt;This link will bring you a very simplified circuit diagram made in
&gt;&gt;pure windows paint (!!)
&gt;&gt;It will give you information about power circuit gain and compensation
&gt;&gt;bits included in the loop.
&gt;&gt;My aim was to include a &quot;double zero&quot; at filter resonance to cancel
&gt;&gt;the phase shift caused by the LC filter.
&gt;&gt;The filter has a resonance frequency of 125Hz, I put a double zero at
&gt;&gt;153Hz.
&gt;&gt;Unfortunately I'm unaware of the ESR in the output caps. I noticed, if
&gt;&gt;it's between 50-100 mOhms, a very nice zero is introduced
&gt;&gt;which make things even better.
&gt;&gt;As I mentioned, I aim for a loop response unity gain frequency of
&gt;&gt;3kHz.
&gt;&gt;I'll be most greatful if you go through my circuit step by step to
&gt;&gt;determine loop compensation stuff.
&gt;&gt;This will be very teaching for me!

&gt;&gt;I appreciate your time and kindness in learning me this tricky things!

&gt;&gt;Regards
&gt;&gt;Stefan

&gt; Hi .
&gt; To be a real help we need all the values of the components.
&gt; They are some component values that are missing. Resistors, capacitors
&gt; and looks like a zener .

&gt; Andy
">

the zener is OK. but the other side of the opto isnt there at all, and
both the zener feed resistor (so we can figure out if it can support the
opto current) and the opto LED resistor are pretty important. Rbias is
irrelevant.

As a general comment, it is common to provide the TL431 bias current by
placing a resistor across the LED. Choose it such that the maximum TL431
bias current almost forward-biases the LED (at the maximum temperature).

for a TL431 its about 1mA, which is going to dump 88mW in the zener
resistor. Then there is the opto current, which is probably a lot more
than 1mA (no way to work it out without the transistor-side circuitry).

Stefan, the basic circuit looks OK (apart from the aforementioned
things), you're certainly on the right track. you just have to include
the entire opto &amp; SG2525 error-amp circuitry in your calcs.

BTW voltage mode is not really the best technique; current mode is
almost always better. It automatically has phenomenal line rejection,
which works on a cycle-by-cycle basis, and of course inherently has peak
primary power limiting. And it magically deals with staircase
saturation, startup issues etc.

Cheers
Terry
</POST>
<POST>
<POSTER> krw &lt;k...@att.bizzzz&gt; </POSTER>
<POSTDATE> 2007-02-09T09:20:00 </POSTDATE>
In article &lt;45CBDAB6.59B66 ... @hotmail.com&gt;,
rabbitsfriendsandrelati ... @hotmail.com says...

<QUOTE PREVIOUSPOST="
&gt; krw wrote:

&gt; &gt; rabbitsfriendsandrelati ... @hotmail.com says...
&gt; &gt; &gt; Henry Kiefer wrote:
&gt; &gt; &gt; &gt; &quot;Eeyore&quot; &lt;rabbitsfriendsandrelati ... @hotmail.com&gt; schrieb im Newsbeitrag
&gt; &gt; &gt; &gt; | Rich Grise wrote:
&gt; &gt; &gt; &gt; |
&gt; &gt; &gt; &gt; | &gt; I have not yet met an ISP who doesn't provide a web page for each of
&gt; &gt; &gt; &gt; | &gt; their customers.
&gt; &gt; &gt; &gt; |
&gt; &gt; &gt; &gt; | My current ISP doesn't. They just provide first class connectivity and a mail server.

&gt; &gt; &gt; &gt; If it is true first class connectivity, then you can run your own server at home.

&gt; &gt; &gt; You can but it's far simpler ( for the time being at least ) to use theirs.

&gt; &gt; Dumb donkey, you just said they didn't support user web pages.
&gt; &gt; Sheesh!

&gt; Since when is a mail server anything to do with use webspace ?
">

The dumb donkey can't read.  Hint from above: "I have not yet met
an ISP who doesn't provide a web page..."  There is nothing in this
threadlet about mail servers.

--
Keith
</POST>
<POST>
<POSTER> Eeyore &lt;rabbitsfriendsandrelati...@hotmail.com&gt; </POSTER>
<POSTDATE> 2007-02-09T09:34:00 </POSTDATE>
<QUOTE PREVIOUSPOST="
krw wrote:
&gt; rabbitsfriendsandrelati ... @hotmail.com says...
&gt; &gt; krw wrote:
&gt; &gt; &gt; rabbitsfriendsandrelati ... @hotmail.com says...
&gt; &gt; &gt; &gt; Henry Kiefer wrote:
&gt; &gt; &gt; &gt; &gt; &quot;Eeyore&quot; &lt;rabbitsfriendsandrelati ... @hotmail.com&gt; schrieb im Newsbeitrag
&gt; &gt; &gt; &gt; &gt; | Rich Grise wrote:
&gt; &gt; &gt; &gt; &gt; |
&gt; &gt; &gt; &gt; &gt; | &gt; I have not yet met an ISP who doesn't provide a web page for each of
&gt; &gt; &gt; &gt; &gt; | &gt; their customers.
&gt; &gt; &gt; &gt; &gt; |
&gt; &gt; &gt; &gt; &gt; | My current ISP doesn't. They just provide first class connectivity and a &gt; &gt; &gt; &gt; &gt; &gt;
&gt; mail server.

&gt; &gt; &gt; &gt; &gt; If it is true first class connectivity, then you can run your own server at home.

&gt; &gt; &gt; &gt; You can but it's far simpler ( for the time being at least ) to use theirs.

&gt; &gt; &gt; Dumb donkey, you just said they didn't support user web pages.
&gt; &gt; &gt; Sheesh!

&gt; &gt; Since when is a mail server anything to do with use webspace ?

&gt; The dumb donkey can't read.  Hint from above: &quot;I have not yet met
&gt; an ISP who doesn't provide a web page...&quot;
">

And I said previously " They just provide first class connectivity and a mail server."

<QUOTE PREVIOUSPOST="
&gt;  There is nothing in this threadlet about mail servers.
">

I suggest you learn to read.

Graham
</POST>
<POST>
<POSTER> krw &lt;k...@att.bizzzz&gt; </POSTER>
<POSTDATE> 2007-02-09T09:57:00 </POSTDATE>
In article &lt;45CC866A.C4E6A ... @hotmail.com&gt;,
rabbitsfriendsandrelati ... @hotmail.com says...

<QUOTE PREVIOUSPOST="
&gt; krw wrote:

&gt; &gt; rabbitsfriendsandrelati ... @hotmail.com says...
&gt; &gt; &gt; krw wrote:
&gt; &gt; &gt; &gt; rabbitsfriendsandrelati ... @hotmail.com says...
&gt; &gt; &gt; &gt; &gt; Henry Kiefer wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &quot;Eeyore&quot; &lt;rabbitsfriendsandrelati ... @hotmail.com&gt; schrieb im Newsbeitrag
&gt; &gt; &gt; &gt; &gt; &gt; | Rich Grise wrote:
&gt; &gt; &gt; &gt; &gt; &gt; |
&gt; &gt; &gt; &gt; &gt; &gt; | &gt; I have not yet met an ISP who doesn't provide a web page for each of
&gt; &gt; &gt; &gt; &gt; &gt; | &gt; their customers.
&gt; &gt; &gt; &gt; &gt; &gt; |
&gt; &gt; &gt; &gt; &gt; &gt; | My current ISP doesn't. They just provide first class connectivity and a &gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; mail server.

&gt; &gt; &gt; &gt; &gt; &gt; If it is true first class connectivity, then you can run your own server at home.

&gt; &gt; &gt; &gt; &gt; You can but it's far simpler ( for the time being at least ) to use theirs.

&gt; &gt; &gt; &gt; Dumb donkey, you just said they didn't support user web pages.
&gt; &gt; &gt; &gt; Sheesh!

&gt; &gt; &gt; Since when is a mail server anything to do with use webspace ?

&gt; &gt; The dumb donkey can't read.  Hint from above: &quot;I have not yet met
&gt; &gt; an ISP who doesn't provide a web page...&quot;

&gt; And I said previously &quot; They just provide first class connectivity and a mail server.&quot;
">

Dumb donkey still can't read.  The particular discussion *was*
about web servers.

<QUOTE PREVIOUSPOST="
&gt; &gt;  There is nothing in this threadlet about mail servers.

&gt; I suggest you learn to read.
">

Dumb donkey still cant read after the obvious has been put right
under his stupid nose.

<QUOTE PREVIOUSPOST="

">

--
Keith
</POST>
<POST>
<POSTER> "Steve" &lt;stefan.toftev...@bredband.net&gt; </POSTER>
<POSTDATE> 2007-02-09T12:31:00 </POSTDATE>
On 9 Feb, 12:23, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

<QUOTE PREVIOUSPOST="
&gt; Andrew Edge wrote:
&gt; &gt; On 8 Feb 2007 12:13:43 -0800, &quot;Steve&quot; &lt;stefan.toftev ... @bredband.net&gt;
&gt; &gt; wrote:

&gt; &gt;&gt;On 8 Feb, 09:40, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt; &gt;&gt;&gt;Steve wrote:

&gt; &gt;&gt;&gt;&gt;On 8 Feb, 06:48, Eeyore &lt;rabbitsfriendsandrelati ... @hotmail.com&gt;
&gt; &gt;&gt;&gt;&gt;wrote:

&gt; &gt;&gt;&gt;&gt;&gt;Steve wrote:

&gt; &gt;&gt;&gt;&gt;&gt;&gt;If you have the time to look at it, I may upload a schematic of the
&gt; &gt;&gt;&gt;&gt;&gt;&gt;entire loop including power circuit gain and compensation bits.

&gt; &gt;&gt;&gt;&gt;&gt;You can't post binaries (attachments) here but if you can get access to
&gt; &gt;&gt;&gt;&gt;&gt;alt.binaries.schematics.electronics that's the ideal place for it. Or put on it one of those free
&gt; &gt;&gt;&gt;&gt;&gt;picture sharing sites.

&gt; &gt;&gt;&gt;&gt;&gt;Graham

&gt; &gt;&gt;&gt;&gt;I've got some own webspace so that's not a problem

&gt; &gt;&gt;&gt;thats even better. ignore my previous post then.

&gt; &gt;&gt;&gt;Cheers
&gt; &gt;&gt;&gt;Terry- Dölj citerad text -

&gt; &gt;&gt;&gt;- Visa citerad text -

&gt; &gt;&gt;Hi Terry!

&gt; &gt;&gt; http://www.etanoldax.se/smps1.JPG

&gt; &gt;&gt;This link will bring you a very simplified circuit diagram made in
&gt; &gt;&gt;pure windows paint (!!)
&gt; &gt;&gt;It will give you information about power circuit gain and compensation
&gt; &gt;&gt;bits included in the loop.
&gt; &gt;&gt;My aim was to include a &quot;double zero&quot; at filter resonance to cancel
&gt; &gt;&gt;the phase shift caused by the LC filter.
&gt; &gt;&gt;The filter has a resonance frequency of 125Hz, I put a double zero at
&gt; &gt;&gt;153Hz.
&gt; &gt;&gt;Unfortunately I'm unaware of the ESR in the output caps. I noticed, if
&gt; &gt;&gt;it's between 50-100 mOhms, a very nice zero is introduced
&gt; &gt;&gt;which make things even better.
&gt; &gt;&gt;As I mentioned, I aim for a loop response unity gain frequency of
&gt; &gt;&gt;3kHz.
&gt; &gt;&gt;I'll be most greatful if you go through my circuit step by step to
&gt; &gt;&gt;determine loop compensation stuff.
&gt; &gt;&gt;This will be very teaching for me!

&gt; &gt;&gt;I appreciate your time and kindness in learning me this tricky things!

&gt; &gt;&gt;Regards
&gt; &gt;&gt;Stefan

&gt; &gt; Hi .
&gt; &gt; To be a real help we need all the values of the components.
&gt; &gt; They are some component values that are missing. Resistors, capacitors
&gt; &gt; and looks like a zener .

&gt; &gt; Andy

&gt; the zener is OK. but the other side of the opto isnt there at all, and
&gt; both the zener feed resistor (so we can figure out if it can support the
&gt; opto current) and the opto LED resistor are pretty important. Rbias is
&gt; irrelevant.

&gt; As a general comment, it is common to provide the TL431 bias current by
&gt; placing a resistor across the LED. Choose it such that the maximum TL431
&gt; bias current almost forward-biases the LED (at the maximum temperature).

&gt; for a TL431 its about 1mA, which is going to dump 88mW in the zener
&gt; resistor. Then there is the opto current, which is probably a lot more
&gt; than 1mA (no way to work it out without the transistor-side circuitry).

&gt; Stefan, the basic circuit looks OK (apart from the aforementioned
&gt; things), you're certainly on the right track. you just have to include
&gt; the entire opto &amp; SG2525 error-amp circuitry in your calcs.

&gt; BTW voltage mode is not really the best technique; current mode is
&gt; almost always better. It automatically has phenomenal line rejection,
&gt; which works on a cycle-by-cycle basis, and of course inherently has peak
&gt; primary power limiting. And it magically deals with staircase
&gt; saturation, startup issues etc.

&gt; Cheers
&gt; Terry- Dölj citerad text -

&gt; - Visa citerad text -
">

Terry,

I've uploaded an improved schematic.
All components are now given a value, including "primary" side opto
circuit and 2525 internal error amp, though is used only as a buffer.

Best regards
Stefan
</POST>
<POST>
<POSTER> Eeyore &lt;rabbitsfriendsandrelati...@hotmail.com&gt; </POSTER>
<POSTDATE> 2007-02-09T13:16:00 </POSTDATE>
<QUOTE PREVIOUSPOST="
Steve wrote:
&gt; I've uploaded an improved schematic.
&gt; All components are now given a value, including &quot;primary&quot; side opto
&gt; circuit and 2525 internal error amp, though is used only as a buffer.
">

Can anyone else take a peek ?

Graham
</POST>
<POST>
<POSTER> Eeyore &lt;rabbitsfriendsandrelati...@hotmail.com&gt; </POSTER>
<POSTDATE> 2007-02-09T13:18:00 </POSTDATE>
<QUOTE PREVIOUSPOST="
krw wrote:
&gt; rabbitsfriendsandrelati ... @hotmail.com says...
&gt; &gt; krw wrote:
&gt; &gt; &gt; rabbitsfriendsandrelati ... @hotmail.com says...
&gt; &gt; &gt; &gt; krw wrote:
&gt; &gt; &gt; &gt; &gt; rabbitsfriendsandrelati ... @hotmail.com says...
&gt; &gt; &gt; &gt; &gt; &gt; Henry Kiefer wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &quot;Eeyore&quot; &lt;rabbitsfriendsandrelati ... @hotmail.com&gt; schrieb im Newsbeitrag
&gt; &gt; &gt; &gt; &gt; &gt; &gt; | Rich Grise wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; |
&gt; &gt; &gt; &gt; &gt; &gt; &gt; | &gt; I have not yet met an ISP who doesn't provide a web page for each of
&gt; &gt; &gt; &gt; &gt; &gt; &gt; | &gt; their customers.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; |
&gt; &gt; &gt; &gt; &gt; &gt; &gt; | My current ISP doesn't. They just provide first class connectivity and a
&gt; &gt; &gt; &gt; &gt; &gt; &gt;   mail server.

&gt; &gt; &gt; &gt; &gt; &gt; &gt; If it is true first class connectivity, then you can run your own server at home.

&gt; &gt; &gt; &gt; &gt; &gt; You can but it's far simpler ( for the time being at least ) to use theirs.

&gt; &gt; &gt; &gt; &gt; Dumb donkey, you just said they didn't support user web pages.
&gt; &gt; &gt; &gt; &gt; Sheesh!

&gt; &gt; &gt; &gt; Since when is a mail server anything to do with use webspace ?

&gt; &gt; &gt; The dumb donkey can't read.  Hint from above: &quot;I have not yet met
&gt; &gt; &gt; an ISP who doesn't provide a web page...&quot;

&gt; &gt; And I said previously &quot; They just provide first class connectivity and a mail server.&quot;

&gt; Dumb donkey still can't read.  The particular discussion *was*
&gt; about web servers.
">

I was indeed responding to the comment  " I have not yet met an ISP who doesn't provide a web page for
each of their customers."

<QUOTE PREVIOUSPOST="
&gt; &gt; &gt;  There is nothing in this threadlet about mail servers.

&gt; &gt; I suggest you learn to read.

&gt; Dumb donkey still cant read after the obvious has been put right
&gt; under his stupid nose.
">

Are you blind or something ?

Graham
</POST>
<POST>
<POSTER> krw &lt;k...@att.bizzzz&gt; </POSTER>
<POSTDATE> 2007-02-09T15:12:00 </POSTDATE>
In article &lt;45CCBB0A.750BF ... @hotmail.com&gt;,
rabbitsfriendsandrelati ... @hotmail.com says...

<QUOTE PREVIOUSPOST="
&gt; krw wrote:

&gt; &gt; rabbitsfriendsandrelati ... @hotmail.com says...
&gt; &gt; &gt; krw wrote:
&gt; &gt; &gt; &gt; rabbitsfriendsandrelati ... @hotmail.com says...
&gt; &gt; &gt; &gt; &gt; krw wrote:
&gt; &gt; &gt; &gt; &gt; &gt; rabbitsfriendsandrelati ... @hotmail.com says...
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Henry Kiefer wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &quot;Eeyore&quot; &lt;rabbitsfriendsandrelati ... @hotmail.com&gt; schrieb im Newsbeitrag
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; | Rich Grise wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; |
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; | &gt; I have not yet met an ISP who doesn't provide a web page for each of
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; | &gt; their customers.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; |
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; | My current ISP doesn't. They just provide first class connectivity and a
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;   mail server.

&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; If it is true first class connectivity, then you can run your own server at home.

&gt; &gt; &gt; &gt; &gt; &gt; &gt; You can but it's far simpler ( for the time being at least ) to use theirs.

&gt; &gt; &gt; &gt; &gt; &gt; Dumb donkey, you just said they didn't support user web pages.
&gt; &gt; &gt; &gt; &gt; &gt; Sheesh!

&gt; &gt; &gt; &gt; &gt; Since when is a mail server anything to do with use webspace ?

&gt; &gt; &gt; &gt; The dumb donkey can't read.  Hint from above: &quot;I have not yet met
&gt; &gt; &gt; &gt; an ISP who doesn't provide a web page...&quot;

&gt; &gt; &gt; And I said previously &quot; They just provide first class connectivity and a mail server.&quot;

&gt; &gt; Dumb donkey still can't read.  The particular discussion *was*
&gt; &gt; about web servers.

&gt; I was indeed responding to the comment  &quot; I have not yet met an ISP who doesn't provide a web page for
&gt; each of their customers.&quot;
">

Dumb donkey...

The original post (with some line wraps and a leading space to
eliminate the auto-quotation) I replied to:

<QUOTE PREVIOUSPOST="
Henry Kiefer wrote:
">

&gt; "Eeyore" &lt;rabbitsfriendsandrelati ... @hotmail.com&gt; schrieb
im Newsbeitrag
&gt; | Rich Grise wrote:
&gt; |
&gt; | &gt; I have not yet met an ISP who doesn't provide a web page
for  each of their customers.

Grease indicates that he had never seen an ISP without web service
bundled.  Ok, so far?

&gt; | My current ISP doesn't. They just provide first class
connectivity and a mail server.

Dumb donkey says his ISP has no web service included.

&gt; If it is true first class connectivity, then you can run
&gt; your own server at home.

HenryK says that if it was such a great ISP you could run your own
web server.

You can but it's far simpler ( for the time being at least )
to use theirs.

Dumber-than-Dirt Donkey says that it's far simpler to use theirs,
which he just said in a reply above, didn't exist.

Get it now Dufus Donkey?  Good, you can stop running from yourself
now.

<QUOTE PREVIOUSPOST="
&gt; &gt; &gt; &gt;  There is nothing in this threadlet about mail servers.

&gt; &gt; &gt; I suggest you learn to read.

&gt; &gt; Dumb donkey still cant read after the obvious has been put right
&gt; &gt; under his stupid nose.

&gt; Are you blind or something ?
">

Someone is, but he ain't on this side of the great pond.

--
Keith
</POST>
<POST>
<POSTER> Terry Given &lt;my_n...@ieee.org&gt; </POSTER>
<POSTDATE> 2007-02-09T15:17:00 </POSTDATE>
<QUOTE PREVIOUSPOST="
Eeyore wrote:

&gt; Steve wrote:

&gt;&gt;I've uploaded an improved schematic.
&gt;&gt;All components are now given a value, including &quot;primary&quot; side opto
&gt;&gt;circuit and 2525 internal error amp, though is used only as a buffer.

&gt; Can anyone else take a peek ?

&gt; Graham
">

yes, but they'll have to have some degree of reading comprehension in
order to do so ;)

Cheers
Terry
</POST>
<POST>
<POSTER> "Henry Kiefer" &lt;otc_fri...@gmx.net&gt; </POSTER>
<POSTDATE> 2007-02-09T15:50:00 </POSTDATE>
"krw" &lt;k ... @att.bizzzz&gt; schrieb im Newsbeitrag news:MPG.20369fc07d694534989f88@news.individual.net ...

<QUOTE PREVIOUSPOST="
&gt;[...]
">

It is really such simple to run a selfowned webserver. At least for simple HTTP. You don't need honkey-donkey SAMBA or Apache.
Updating your webspace is much simpler then. Just drag the files to the webroot directory and it is online. No ftp needed.

Try www.aidex.de It is free, small, effective. Forgive me if it is german language.
A bigger candidate is Abyss Web Server - even free and english spoken.

But you need a 24/7 online for best results and dyndns update if your IP changes. Also free.

All free and no commercial breaks - great, isn't it??

- Henry

--
www.ehydra.dyndns.info
</POST>
<POST>
<POSTER> Eeyore &lt;rabbitsfriendsandrelati...@hotmail.com&gt; </POSTER>
<POSTDATE> 2007-02-09T22:44:00 </POSTDATE>
<QUOTE PREVIOUSPOST="
krw wrote:
&gt; rabbitsfriendsandrelati ... @hotmail.com says...
&gt; &gt; krw wrote:
&gt; &gt; &gt; rabbitsfriendsandrelati ... @hotmail.com says...
&gt; &gt; &gt; &gt; krw wrote:
&gt; &gt; &gt; &gt; &gt; rabbitsfriendsandrelati ... @hotmail.com says...
&gt; &gt; &gt; &gt; &gt; &gt; krw wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; rabbitsfriendsandrelati ... @hotmail.com says...
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Henry Kiefer wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &quot;Eeyore&quot; &lt;rabbitsfriendsandrelati ... @hotmail.com&gt; schrieb
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; | Rich Grise wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; |
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; | &gt; I have not yet met an ISP who doesn't provide a web page for each
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; | &gt; of their customers.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; |
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; | My current ISP doesn't. They just provide first class connectivity and a
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;   mail server.

&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; If it is true first class connectivity, then you can run your own server at &gt; &gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; home.

&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; You can but it's far simpler ( for the time being at least ) to use theirs.

&gt; &gt; &gt; &gt; &gt; &gt; &gt; Dumb donkey, you just said they didn't support user web pages.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Sheesh!

&gt; &gt; &gt; &gt; &gt; &gt; Since when is a mail server anything to do with use webspace ?

&gt; &gt; &gt; &gt; &gt; The dumb donkey can't read.  Hint from above: &quot;I have not yet met
&gt; &gt; &gt; &gt; &gt; an ISP who doesn't provide a web page...&quot;

&gt; &gt; &gt; &gt; And I said previously &quot; They just provide first class connectivity and a mail server.&quot;

&gt; &gt; &gt; Dumb donkey still can't read.  The particular discussion *was*
&gt; &gt; &gt; about web servers.

&gt; &gt; I was indeed responding to the comment  &quot; I have not yet met an ISP who doesn't &gt; provide a web page for
&gt; each of their customers.&quot;

&gt; Dumb donkey...
">

Dumb KRW.

<QUOTE PREVIOUSPOST="
&gt; The original post (with some line wraps and a leading space to
&gt; eliminate the auto-quotation) I replied to:

&gt;  Henry Kiefer wrote:

&gt;  &gt; &quot;Eeyore&quot; &lt;rabbitsfriendsandrelati ... @hotmail.com&gt; schrieb
&gt;  &gt; | Rich Grise wrote:
&gt;  &gt; |
&gt;  &gt; | &gt; I have not yet met an ISP who doesn't provide a web page
&gt;        for  each of their customers.

&gt; Grease indicates that he had never seen an ISP without web service
&gt; bundled.  Ok, so far?
">

Absolutely fine.

<QUOTE PREVIOUSPOST="
&gt;  &gt; | My current ISP doesn't. They just provide first class
&gt;      connectivity and a mail server.

&gt; Dumb donkey says his ISP has no web service included.
">

Dumb KRW has it right so far.

<QUOTE PREVIOUSPOST="
&gt;  &gt; If it is true first class connectivity, then you can run
&gt;  &gt; your own server at home.

&gt; HenryK says that if it was such a great ISP you could run your own
&gt; web server.
">

Absolutely wrong. He said server without specifying web or mail.

<QUOTE PREVIOUSPOST="
&gt;  You can but it's far simpler ( for the time being at least )
&gt;  to use theirs.

&gt; Dumber-than-Dirt Donkey says that it's far simpler to use theirs,
&gt; which he just said in a reply above, didn't exist.
">

To use their mail server rather than set up your own.

<QUOTE PREVIOUSPOST="
&gt; Get it now Dufus Donkey?  Good, you can stop running from yourself
&gt; now.
">

I get it that you're incapable of understand what's in front of your nose.

Now grow up !

Graham
</POST>
<POST>
<POSTER> jasen &lt;j...@free.net.nz&gt; </POSTER>
<POSTDATE> 2007-02-10T00:35:00 </POSTDATE>
On 2007-02-08, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

Organization: Slingshot Internet
NNTP-Posting-Host: news.tranzpeer.net
X-Complaints-To: abuse@ihug.co.nz

<QUOTE PREVIOUSPOST="
&gt; can you email it to me? my crappy ISP wont let me see ABSE, and Im way
&gt; too lazy to figure out any other way of doing it. you can deduce my
&gt; email from the post :)
">

If you ever feel like switching ISPs, Clear carries it.

Bye.
Jasen
</POST>
<POST>
<POSTER> krw &lt;k...@att.bizzzz&gt; </POSTER>
<POSTDATE> 2007-02-10T12:20:00 </POSTDATE>
In article &lt;45CD3F83.9EB9B ... @hotmail.com&gt;,
rabbitsfriendsandrelati ... @hotmail.com says...

<QUOTE PREVIOUSPOST="
&gt; krw wrote:

&gt; &gt; rabbitsfriendsandrelati ... @hotmail.com says...
&gt; &gt; &gt; krw wrote:
&gt; &gt; &gt; &gt; rabbitsfriendsandrelati ... @hotmail.com says...
&gt; &gt; &gt; &gt; &gt; krw wrote:
&gt; &gt; &gt; &gt; &gt; &gt; rabbitsfriendsandrelati ... @hotmail.com says...
&gt; &gt; &gt; &gt; &gt; &gt; &gt; krw wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; rabbitsfriendsandrelati ... @hotmail.com says...
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Henry Kiefer wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &quot;Eeyore&quot; &lt;rabbitsfriendsandrelati ... @hotmail.com&gt; schrieb
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; | Rich Grise wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; |
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; | &gt; I have not yet met an ISP who doesn't provide a web page for each
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; | &gt; of their customers.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; |
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; | My current ISP doesn't. They just provide first class connectivity and a
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;   mail server.

&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; If it is true first class connectivity, then you can run your own server at &gt; &gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; home.

&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; You can but it's far simpler ( for the time being at least ) to use theirs.

&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Dumb donkey, you just said they didn't support user web pages.
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; Sheesh!

&gt; &gt; &gt; &gt; &gt; &gt; &gt; Since when is a mail server anything to do with use webspace ?

&gt; &gt; &gt; &gt; &gt; &gt; The dumb donkey can't read.  Hint from above: &quot;I have not yet met
&gt; &gt; &gt; &gt; &gt; &gt; an ISP who doesn't provide a web page...&quot;

&gt; &gt; &gt; &gt; &gt; And I said previously &quot; They just provide first class connectivity and a mail server.&quot;

&gt; &gt; &gt; &gt; Dumb donkey still can't read.  The particular discussion *was*
&gt; &gt; &gt; &gt; about web servers.

&gt; &gt; &gt; I was indeed responding to the comment  &quot; I have not yet met an ISP who doesn't &gt; provide a web page for
&gt; &gt; each of their customers.&quot;

&gt; &gt; Dumb donkey...

&gt; Dumb KRW.
">

How original.  Considering the source...

<QUOTE PREVIOUSPOST="
- Hide quoted text - - Show quoted text -
">

<QUOTE PREVIOUSPOST="
&gt; &gt; The original post (with some line wraps and a leading space to
&gt; &gt; eliminate the auto-quotation) I replied to:

&gt; &gt;  Henry Kiefer wrote:

&gt; &gt;  &gt; &quot;Eeyore&quot; &lt;rabbitsfriendsandrelati ... @hotmail.com&gt; schrieb
&gt; &gt;  &gt; | Rich Grise wrote:
&gt; &gt;  &gt; |
&gt; &gt;  &gt; | &gt; I have not yet met an ISP who doesn't provide a web page
&gt; &gt;        for  each of their customers.

&gt; &gt; Grease indicates that he had never seen an ISP without web service
&gt; &gt; bundled.  Ok, so far?

&gt; Absolutely fine.
">

As is the rest.

<QUOTE PREVIOUSPOST="
&gt; &gt;  &gt; | My current ISP doesn't. They just provide first class
&gt; &gt;      connectivity and a mail server.

&gt; &gt; Dumb donkey says his ISP has no web service included.

&gt; Dumb KRW has it right so far.
">

Even the part about "dumb donkey".

<QUOTE PREVIOUSPOST="
&gt; &gt;  &gt; If it is true first class connectivity, then you can run
&gt; &gt;  &gt; your own server at home.

&gt; &gt; HenryK says that if it was such a great ISP you could run your own
&gt; &gt; web server.

&gt; Absolutely wrong. He said server without specifying web or mail.
">

Dumber-than-dirt donkey, the context from above was a WEB SERVER.
Why bother quoting if you can't read them?

<QUOTE PREVIOUSPOST="
&gt; &gt;  You can but it's far simpler ( for the time being at least )
&gt; &gt;  to use theirs.

&gt; &gt; Dumber-than-Dirt Donkey says that it's far simpler to use theirs,
&gt; &gt; which he just said in a reply above, didn't exist.

&gt; To use their mail server rather than set up your own.
">

The issue at hand was WEB SERVERS.  You stepped in your own dirt,
dumb donkey.

<QUOTE PREVIOUSPOST="
&gt; &gt; Get it now Dufus Donkey?  Good, you can stop running from yourself
&gt; &gt; now.

&gt; I get it that you're incapable of understand what's in front of your nose.
">

You're incapable of reading, even when when I lay it out in front
of your stupid stubborn donkey nose.

<QUOTE PREVIOUSPOST="
&gt; Now grow up !
">

Now learn to read.

--
Keith
</POST>
<POST>
<POSTER> Eeyore &lt;rabbitsfriendsandrelati...@hotmail.com&gt; </POSTER>
<POSTDATE> 2007-02-10T17:33:00 </POSTDATE>
<QUOTE PREVIOUSPOST="
krw wrote:
&gt; rabbitsfriendsandrelati ... @hotmail.com says...

&gt; &gt; I get it that you're incapable of understand what's in front of your nose.

&gt; You're incapable of reading, even when when I lay it out in front
&gt; of your stupid stubborn donkey nose.
">

Nerr, nerr, nerr. I said that first.

Graham
</POST>
<POST>
<POSTER> krw &lt;k...@att.bizzzz&gt; </POSTER>
<POSTDATE> 2007-02-10T17:46:00 </POSTDATE>
In article &lt;45CE4838.1FA2F ... @hotmail.com&gt;,
rabbitsfriendsandrelati ... @hotmail.com says...

<QUOTE PREVIOUSPOST="
&gt; krw wrote:

&gt; &gt; rabbitsfriendsandrelati ... @hotmail.com says...

&gt; &gt; &gt; I get it that you're incapable of understand what's in front of your nose.

&gt; &gt; You're incapable of reading, even when when I lay it out in front
&gt; &gt; of your stupid stubborn donkey nose.

&gt; Nerr, nerr, nerr. I said that first.
">

I'll take that as an admission that you're an illiterate dumb
donkey.  Moved goal posts noted.

--
Keith
</POST>
<POST>
<POSTER> Eeyore &lt;rabbitsfriendsandrelati...@hotmail.com&gt; </POSTER>
<POSTDATE> 2007-02-10T17:58:00 </POSTDATE>
<QUOTE PREVIOUSPOST="
krw wrote:
&gt; rabbitsfriendsandrelati ... @hotmail.com says...
&gt; &gt; krw wrote:
&gt; &gt; &gt; rabbitsfriendsandrelati ... @hotmail.com says...

&gt; &gt; &gt; &gt; I get it that you're incapable of understand what's in front of your nose.

&gt; &gt; &gt; You're incapable of reading, even when when I lay it out in front
&gt; &gt; &gt; of your stupid stubborn donkey nose.

&gt; &gt; Nerr, nerr, nerr. I said that first.

&gt; I'll take that as an admission that you're an illiterate dumb
&gt; donkey.  Moved goal posts noted.
">

I take that as an admission you need to lighten up.

Not playing any more now.  :-p

Graham
</POST>
<POST>
<POSTER> krw &lt;k...@att.bizzzz&gt; </POSTER>
<POSTDATE> 2007-02-11T11:51:00 </POSTDATE>
In article &lt;45CE4DF9.A1469 ... @hotmail.com&gt;,
rabbitsfriendsandrelati ... @hotmail.com says...

<QUOTE PREVIOUSPOST="
&gt; krw wrote:

&gt; &gt; rabbitsfriendsandrelati ... @hotmail.com says...
&gt; &gt; &gt; krw wrote:
&gt; &gt; &gt; &gt; rabbitsfriendsandrelati ... @hotmail.com says...

&gt; &gt; &gt; &gt; &gt; I get it that you're incapable of understand what's in front of your nose.

&gt; &gt; &gt; &gt; You're incapable of reading, even when when I lay it out in front
&gt; &gt; &gt; &gt; of your stupid stubborn donkey nose.

&gt; &gt; &gt; Nerr, nerr, nerr. I said that first.

&gt; &gt; I'll take that as an admission that you're an illiterate dumb
&gt; &gt; donkey.  Moved goal posts noted.

&gt; I take that as an admission you need to lighten up.
">

Why should I lighten up.  It's fun whacking dumb donkeys.  It makes
'em look even dumber when they squirm.

<QUOTE PREVIOUSPOST="
&gt; Not playing any more now.  :-p
">

You will.  You can't resist making an ass out of yourself.

--
Keith
</POST>
<POST>
<POSTER> Terry Given &lt;my_n...@ieee.org&gt; </POSTER>
<POSTDATE> 2007-02-12T04:08:00 </POSTDATE>
<QUOTE PREVIOUSPOST="
Steve wrote:
&gt; On 9 Feb, 12:23, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt;&gt;Andrew Edge wrote:

&gt;&gt;&gt;On 8 Feb 2007 12:13:43 -0800, &quot;Steve&quot; &lt;stefan.toftev ... @bredband.net&gt;
&gt;&gt;&gt;wrote:

&gt;&gt;&gt;&gt;On 8 Feb, 09:40, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt;&gt;&gt;&gt;&gt;Steve wrote:

&gt;&gt;&gt;&gt;&gt;&gt;On 8 Feb, 06:48, Eeyore &lt;rabbitsfriendsandrelati ... @hotmail.com&gt;
&gt;&gt;&gt;&gt;&gt;&gt;wrote:

&gt;&gt;&gt;&gt;&gt;&gt;&gt;Steve wrote:

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;If you have the time to look at it, I may upload a schematic of the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;entire loop including power circuit gain and compensation bits.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;You can't post binaries (attachments) here but if you can get access to
&gt;&gt;&gt;&gt;&gt;&gt;&gt;alt.binaries.schematics.electronics that's the ideal place for it. Or put on it one of those free
&gt;&gt;&gt;&gt;&gt;&gt;&gt;picture sharing sites.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;Graham

&gt;&gt;&gt;&gt;&gt;&gt;I've got some own webspace so that's not a problem

&gt;&gt;&gt;&gt;&gt;thats even better. ignore my previous post then.

&gt;&gt;&gt;&gt;&gt;Cheers
&gt;&gt;&gt;&gt;&gt;Terry- Dölj citerad text -

&gt;&gt;&gt;&gt;&gt;- Visa citerad text -

&gt;&gt;&gt;&gt;Hi Terry!

&gt;&gt;&gt;&gt; http://www.etanoldax.se/smps1.JPG

&gt;&gt;&gt;&gt;This link will bring you a very simplified circuit diagram made in
&gt;&gt;&gt;&gt;pure windows paint (!!)
&gt;&gt;&gt;&gt;It will give you information about power circuit gain and compensation
&gt;&gt;&gt;&gt;bits included in the loop.
&gt;&gt;&gt;&gt;My aim was to include a &quot;double zero&quot; at filter resonance to cancel
&gt;&gt;&gt;&gt;the phase shift caused by the LC filter.
&gt;&gt;&gt;&gt;The filter has a resonance frequency of 125Hz, I put a double zero at
&gt;&gt;&gt;&gt;153Hz.
&gt;&gt;&gt;&gt;Unfortunately I'm unaware of the ESR in the output caps. I noticed, if
&gt;&gt;&gt;&gt;it's between 50-100 mOhms, a very nice zero is introduced
&gt;&gt;&gt;&gt;which make things even better.
&gt;&gt;&gt;&gt;As I mentioned, I aim for a loop response unity gain frequency of
&gt;&gt;&gt;&gt;3kHz.
&gt;&gt;&gt;&gt;I'll be most greatful if you go through my circuit step by step to
&gt;&gt;&gt;&gt;determine loop compensation stuff.
&gt;&gt;&gt;&gt;This will be very teaching for me!

&gt;&gt;&gt;&gt;I appreciate your time and kindness in learning me this tricky things!

&gt;&gt;&gt;&gt;Regards
&gt;&gt;&gt;&gt;Stefan

&gt;&gt;&gt;Hi .
&gt;&gt;&gt;To be a real help we need all the values of the components.
&gt;&gt;&gt;They are some component values that are missing. Resistors, capacitors
&gt;&gt;&gt;and looks like a zener .

&gt;&gt;&gt;Andy

&gt;&gt;the zener is OK. but the other side of the opto isnt there at all, and
&gt;&gt;both the zener feed resistor (so we can figure out if it can support the
&gt;&gt;opto current) and the opto LED resistor are pretty important. Rbias is
&gt;&gt;irrelevant.

&gt;&gt;As a general comment, it is common to provide the TL431 bias current by
&gt;&gt;placing a resistor across the LED. Choose it such that the maximum TL431
&gt;&gt;bias current almost forward-biases the LED (at the maximum temperature).

&gt;&gt;for a TL431 its about 1mA, which is going to dump 88mW in the zener
&gt;&gt;resistor. Then there is the opto current, which is probably a lot more
&gt;&gt;than 1mA (no way to work it out without the transistor-side circuitry).

&gt;&gt;Stefan, the basic circuit looks OK (apart from the aforementioned
&gt;&gt;things), you're certainly on the right track. you just have to include
&gt;&gt;the entire opto &amp; SG2525 error-amp circuitry in your calcs.

&gt;&gt;BTW voltage mode is not really the best technique; current mode is
&gt;&gt;almost always better. It automatically has phenomenal line rejection,
&gt;&gt;which works on a cycle-by-cycle basis, and of course inherently has peak
&gt;&gt;primary power limiting. And it magically deals with staircase
&gt;&gt;saturation, startup issues etc.

&gt;&gt;Cheers
&gt;&gt;Terry- Dölj citerad text -

&gt;&gt;- Visa citerad text -

&gt; Terry,

&gt; I've uploaded an improved schematic.
&gt; All components are now given a value, including &quot;primary&quot; side opto
&gt; circuit and 2525 internal error amp, though is used only as a buffer.

&gt; Best regards
&gt; Stefan
">

OK.

Firstly, I wonder what the effect of measuring the voltage across both
outputs is. I look at that and think that Ltotal = 160uH and Ctotal =
10mF. So a quick energy balance:

I+ = I- = I (balanced load)

E_L1 = 0.5*80uH*I^2

E_L2 = 0.5*80uH*I^2

E_L = 0.5*160uH*I^2. OK, the L's sum.

likewise for the caps:

E_C1 = 0.5*20mF*(V/2)^2,

E_C2 = 0.5*20mF*(V/2)^2,

E_c = 20mF*(V/2)^2 = 0.5*10mF*V^2

so a re-drawn circuit is:

---] xfmr  [---[160uH]--[ESR_L]--+---- +100V
40T     40T                    |
[10mF]
|
[ESR_C]
|
0V

DC gain = (Vin/Vramp)*(Ns/Np) = (320/2.6)*(40/40) = 123

note: if you regulated only one output, then you would reflect the other
LC circuit (easy, same no. of turns) to the regulated output, and
calculate the parallel equivalent, giving 40uH + 40mF, and the DC gain
would be 61.5

Note that the effective inductor ESR is the sum of the two; for the
caps, it turns out to be that of a single 10mF cap, as each 20mF cap is
2 in parallel (ESR_20mF = 0.5*ESR_10mF) so the sum is ESR_10mF

You can usually ignore the choke ESR. Because it has the full output
current flowing thru it, the choke is (usually, not always) designed for
extremely low losses (hence low ESR). if its not quite negligible, the
next approximation is to add it to the cap ESR. Or you can just use the
actual transfer function:

The AC transfer function of the power stage is:

Vout(s)/Vc(s) = Xc(s)/[Xc(s) + Xl(s)]

Xc(s) = ESR_C = 1/(s*C)

Xl(s) = ESR_L + s*L

(s = j*w)

the zener resistor current is 11mA c.f. a shunt circuit maximum of

Ishunt_max = (12 - 1.2 - 2.5)/2k2 = 8.3mA

this is a lot higher than your 5mA figure. I guesstimated Vled = 1.2V.
The TL431 cant pull lower than 2.5V.

regardless, 8.3mA &lt; 11mA, so the zener will clamp the opto supply at ~
12V, and it wont vary by much.

the LED will see a maximum of 8.3mA - 1.2mA (the 1k resistor) = 7.1mA.

OK, we've established the zener shunt regulator works.

The TL431 circuit transfer function (from Vout to Vk) is:

Vk(s)/Vout(s) = -Zf(s)/Zin(s)

// = parallel

Zf(s) = [1/(s*220pF)]//(47k + 1/(s*22nF))

Zin(s) = 47k + 47k//[1/(s*22nF)]

the transfer function from Vk to Iled is simply -1/2k2

so Iled(s)/Vout(s) = (1/2k2)*Zf(s)/Zin(s)

the transfer function from the opto transistor to led is:

Ibjt(s)/Iled(s) = CTR*1/(1+s/w_opto)

where w_opto is the corner frequency of the opto itself. You probably
cant ignore this.

and to get from the opto bjt to the control voltage, the transfer
function is Acl(s)*(-8k2)

its -8k2 because the voltage is (5V - 8k2*Ibjt), and the 5V (being
constant) disappears when you take partial derivatives.

where Acl(s) is the error amplifier closed-loop gain. for a shitty old
smps controller, these error amplifiers can have quite low GBW. look it
up in the datasheet, but I suspect you can ignore it as the gain is one.

Acl(s) = 1/(1+s/(2*pi*GBW))

OK, I looked it up, its 1MHz so you can safely ignore the controller
error amp, and set

Acl(s) = 1.

Putting it all together, you get:

Vc(s)/Vout(s) = 1*(-8k2)*CTR*[1/(1+s/w_opto)]*(1/2k2)*Zf(s)/Zin(s)

simplifying:

Vc(s)/Vout(s) = -3.73*CTR*[1/(1+s/w_opto)]*Zf(s)/Zin(s)

and thats all you need to close your loop.

I might have made an algebraic error or 6, but the technique is pretty
much there. If I was being paid, I'd be very careful to get it right :)

Cheers
Terry
</POST>
<POST>
<POSTER> Andrew Edge &lt;a_n_d_y_e_d_...@mswsystems.com&gt; </POSTER>
<POSTDATE> 2007-02-13T02:52:00 </POSTDATE>
On 9 Feb 2007 09:31:48 -0800, "Steve" &lt;stefan.toftev ... @bredband.net&gt;
wrote:

<QUOTE PREVIOUSPOST="
&gt;On 9 Feb, 12:23, Terry Given &lt;my_n ... @ieee.org&gt; wrote:
&gt;&gt; Andrew Edge wrote:
&gt;&gt; &gt; On 8 Feb 2007 12:13:43 -0800, &quot;Steve&quot; &lt;stefan.toftev ... @bredband.net&gt;
&gt;&gt; &gt; wrote:

&gt;&gt; &gt;&gt;On 8 Feb, 09:40, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt;&gt; &gt;&gt;&gt;Steve wrote:

&gt;&gt; &gt;&gt;&gt;&gt;On 8 Feb, 06:48, Eeyore &lt;rabbitsfriendsandrelati ... @hotmail.com&gt;
&gt;&gt; &gt;&gt;&gt;&gt;wrote:

&gt;&gt; &gt;&gt;&gt;&gt;&gt;Steve wrote:

&gt;&gt; &gt;&gt;&gt;&gt;&gt;&gt;If you have the time to look at it, I may upload a schematic of the
&gt;&gt; &gt;&gt;&gt;&gt;&gt;&gt;entire loop including power circuit gain and compensation bits.

&gt;&gt; &gt;&gt;&gt;&gt;&gt;You can't post binaries (attachments) here but if you can get access to
&gt;&gt; &gt;&gt;&gt;&gt;&gt;alt.binaries.schematics.electronics that's the ideal place for it. Or put on it one of those free
&gt;&gt; &gt;&gt;&gt;&gt;&gt;picture sharing sites.

&gt;&gt; &gt;&gt;&gt;&gt;&gt;Graham

&gt;&gt; &gt;&gt;&gt;&gt;I've got some own webspace so that's not a problem

&gt;&gt; &gt;&gt;&gt;thats even better. ignore my previous post then.

&gt;&gt; &gt;&gt;&gt;Cheers
&gt;&gt; &gt;&gt;&gt;Terry- Dölj citerad text -

&gt;&gt; &gt;&gt;&gt;- Visa citerad text -

&gt;&gt; &gt;&gt;Hi Terry!

&gt;&gt; &gt;&gt; http://www.etanoldax.se/smps1.JPG

&gt;&gt; &gt;&gt;This link will bring you a very simplified circuit diagram made in
&gt;&gt; &gt;&gt;pure windows paint (!!)
&gt;&gt; &gt;&gt;It will give you information about power circuit gain and compensation
&gt;&gt; &gt;&gt;bits included in the loop.
&gt;&gt; &gt;&gt;My aim was to include a &quot;double zero&quot; at filter resonance to cancel
&gt;&gt; &gt;&gt;the phase shift caused by the LC filter.
&gt;&gt; &gt;&gt;The filter has a resonance frequency of 125Hz, I put a double zero at
&gt;&gt; &gt;&gt;153Hz.
&gt;&gt; &gt;&gt;Unfortunately I'm unaware of the ESR in the output caps. I noticed, if
&gt;&gt; &gt;&gt;it's between 50-100 mOhms, a very nice zero is introduced
&gt;&gt; &gt;&gt;which make things even better.
&gt;&gt; &gt;&gt;As I mentioned, I aim for a loop response unity gain frequency of
&gt;&gt; &gt;&gt;3kHz.
&gt;&gt; &gt;&gt;I'll be most greatful if you go through my circuit step by step to
&gt;&gt; &gt;&gt;determine loop compensation stuff.
&gt;&gt; &gt;&gt;This will be very teaching for me!

&gt;&gt; &gt;&gt;I appreciate your time and kindness in learning me this tricky things!

&gt;&gt; &gt;&gt;Regards
&gt;&gt; &gt;&gt;Stefan

&gt;&gt; &gt; Hi .
&gt;&gt; &gt; To be a real help we need all the values of the components.
&gt;&gt; &gt; They are some component values that are missing. Resistors, capacitors
&gt;&gt; &gt; and looks like a zener .

&gt;&gt; &gt; Andy

&gt;&gt; the zener is OK. but the other side of the opto isnt there at all, and
&gt;&gt; both the zener feed resistor (so we can figure out if it can support the
&gt;&gt; opto current) and the opto LED resistor are pretty important. Rbias is
&gt;&gt; irrelevant.

&gt;&gt; As a general comment, it is common to provide the TL431 bias current by
&gt;&gt; placing a resistor across the LED. Choose it such that the maximum TL431
&gt;&gt; bias current almost forward-biases the LED (at the maximum temperature).

&gt;&gt; for a TL431 its about 1mA, which is going to dump 88mW in the zener
&gt;&gt; resistor. Then there is the opto current, which is probably a lot more
&gt;&gt; than 1mA (no way to work it out without the transistor-side circuitry).

&gt;&gt; Stefan, the basic circuit looks OK (apart from the aforementioned
&gt;&gt; things), you're certainly on the right track. you just have to include
&gt;&gt; the entire opto &amp; SG2525 error-amp circuitry in your calcs.

&gt;&gt; BTW voltage mode is not really the best technique; current mode is
&gt;&gt; almost always better. It automatically has phenomenal line rejection,
&gt;&gt; which works on a cycle-by-cycle basis, and of course inherently has peak
&gt;&gt; primary power limiting. And it magically deals with staircase
&gt;&gt; saturation, startup issues etc.

&gt;&gt; Cheers
&gt;&gt; Terry- Dölj citerad text -

&gt;&gt; - Visa citerad text -

&gt;Terry,

&gt;I've uploaded an improved schematic.
&gt;All components are now given a value, including &quot;primary&quot; side opto
&gt;circuit and 2525 internal error amp, though is used only as a buffer.

&gt;Best regards
&gt;Stefan
">

Where did you upload that ... I still see the old circuit .

Andy
</POST>
<POST>
<POSTER> "Steve" &lt;stefan.toftev...@bredband.net&gt; </POSTER>
<POSTDATE> 2007-02-14T04:50:00 </POSTDATE>
On 12 Feb, 10:08, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

<QUOTE PREVIOUSPOST="
&gt; Steve wrote:
&gt; &gt; On 9 Feb, 12:23, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt; &gt;&gt;Andrew Edge wrote:

&gt; &gt;&gt;&gt;On 8 Feb 2007 12:13:43 -0800, &quot;Steve&quot; &lt;stefan.toftev ... @bredband.net&gt;
&gt; &gt;&gt;&gt;wrote:

&gt; &gt;&gt;&gt;&gt;On 8 Feb, 09:40, Terry Given &lt;my_n ... @ieee.org&gt; wrote:

&gt; &gt;&gt;&gt;&gt;&gt;Steve wrote:

&gt; &gt;&gt;&gt;&gt;&gt;&gt;On 8 Feb, 06:48, Eeyore &lt;rabbitsfriendsandrelati ... @hotmail.com&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;wrote:

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;Steve wrote:

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;If you have the time to look at it, I may upload a schematic of the
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;entire loop including power circuit gain and compensation bits.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;You can't post binaries (attachments) here but if you can get access to
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;alt.binaries.schematics.electronics that's the ideal place for it. Or put on it one of those free
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;picture sharing sites.

&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;Graham

&gt; &gt;&gt;&gt;&gt;&gt;&gt;I've got some own webspace so that's not a problem

&gt; &gt;&gt;&gt;&gt;&gt;thats even better. ignore my previous post then.

&gt; &gt;&gt;&gt;&gt;&gt;Cheers
&gt; &gt;&gt;&gt;&gt;&gt;Terry- Dölj citerad text -

&gt; &gt;&gt;&gt;&gt;&gt;- Visa citerad text -

&gt; &gt;&gt;&gt;&gt;Hi Terry!

&gt; &gt;&gt;&gt;&gt; http://www.etanoldax.se/smps1.JPG

&gt; &gt;&gt;&gt;&gt;This link will bring you a very simplified circuit diagram made in
&gt; &gt;&gt;&gt;&gt;pure windows paint (!!)
&gt; &gt;&gt;&gt;&gt;It will give you information about power circuit gain and compensation
&gt; &gt;&gt;&gt;&gt;bits included in the loop.
&gt; &gt;&gt;&gt;&gt;My aim was to include a &quot;double zero&quot; at filter resonance to cancel
&gt; &gt;&gt;&gt;&gt;the phase shift caused by the LC filter.
&gt; &gt;&gt;&gt;&gt;The filter has a resonance frequency of 125Hz, I put a double zero at
&gt; &gt;&gt;&gt;&gt;153Hz.
&gt; &gt;&gt;&gt;&gt;Unfortunately I'm unaware of the ESR in the output caps. I noticed, if
&gt; &gt;&gt;&gt;&gt;it's between 50-100 mOhms, a very nice zero is introduced
&gt; &gt;&gt;&gt;&gt;which make things even better.
&gt; &gt;&gt;&gt;&gt;As I mentioned, I aim for a loop response unity gain frequency of
&gt; &gt;&gt;&gt;&gt;3kHz.
&gt; &gt;&gt;&gt;&gt;I'll be most greatful if you go through my circuit step by step to
&gt; &gt;&gt;&gt;&gt;determine loop compensation stuff.
&gt; &gt;&gt;&gt;&gt;This will be very teaching for me!

&gt; &gt;&gt;&gt;&gt;I appreciate your time and kindness in learning me this tricky things!

&gt; &gt;&gt;&gt;&gt;Regards
&gt; &gt;&gt;&gt;&gt;Stefan

&gt; &gt;&gt;&gt;Hi .
&gt; &gt;&gt;&gt;To be a real help we need all the values of the components.
&gt; &gt;&gt;&gt;They are some component values that are missing. Resistors, capacitors
&gt; &gt;&gt;&gt;and looks like a zener .

&gt; &gt;&gt;&gt;Andy

&gt; &gt;&gt;the zener is OK. but the other side of the opto isnt there at all, and
&gt; &gt;&gt;both the zener feed resistor (so we can figure out if it can support the
&gt; &gt;&gt;opto current) and the opto LED resistor are pretty important. Rbias is
&gt; &gt;&gt;irrelevant.

&gt; &gt;&gt;As a general comment, it is common to provide the TL431 bias current by
&gt; &gt;&gt;placing a resistor across the LED. Choose it such that the maximum TL431
&gt; &gt;&gt;bias current almost forward-biases the LED (at the maximum temperature).

&gt; &gt;&gt;for a TL431 its about 1mA, which is going to dump 88mW in the zener
&gt; &gt;&gt;resistor. Then there is the opto current, which is probably a lot more
&gt; &gt;&gt;than 1mA (no way to work it out without the transistor-side circuitry).

&gt; &gt;&gt;Stefan, the basic circuit looks OK (apart from the aforementioned
&gt; &gt;&gt;things), you're certainly on the right track. you just have to include
&gt; &gt;&gt;the entire opto &amp; SG2525 error-amp circuitry in your calcs.

&gt; &gt;&gt;BTW voltage mode is not really the best technique; current mode is
&gt; &gt;&gt;almost always better. It automatically has phenomenal line rejection,
&gt; &gt;&gt;which works on a cycle-by-cycle basis, and of course inherently has peak
&gt; &gt;&gt;primary power limiting. And it magically deals with staircase
&gt; &gt;&gt;saturation, startup issues etc.

&gt; &gt;&gt;Cheers
&gt; &gt;&gt;Terry- Dölj citerad text -

&gt; &gt;&gt;- Visa citerad text -

&gt; &gt; Terry,

&gt; &gt; I've uploaded an improved schematic.
&gt; &gt; All components are now given a value, including &quot;primary&quot; side opto
&gt; &gt; circuit and 2525 internal error amp, though is used only as a buffer.

&gt; &gt; Best regards
&gt; &gt; Stefan

&gt; OK.

&gt; Firstly, I wonder what the effect of measuring the voltage across both
&gt; outputs is. I look at that and think that Ltotal = 160uH and Ctotal =
&gt; 10mF. So a quick energy balance:

&gt; I+ = I- = I (balanced load)

&gt; E_L1 = 0.5*80uH*I^2

&gt; E_L2 = 0.5*80uH*I^2

&gt; E_L = 0.5*160uH*I^2. OK, the L's sum.

&gt; likewise for the caps:

&gt; E_C1 = 0.5*20mF*(V/2)^2,

&gt; E_C2 = 0.5*20mF*(V/2)^2,

&gt; E_c = 20mF*(V/2)^2 = 0.5*10mF*V^2

&gt; so a re-drawn circuit is:

&gt; ---] xfmr  [---[160uH]--[ESR_L]--+---- +100V
&gt;    40T     40T                    |
&gt;                                 [10mF]
&gt;                                   |
&gt;                                [ESR_C]
&gt;                                   |
&gt;                                  0V

&gt; DC gain = (Vin/Vramp)*(Ns/Np) = (320/2.6)*(40/40) = 123

&gt; note: if you regulated only one output, then you would reflect the other
&gt; LC circuit (easy, same no. of turns) to the regulated output, and
&gt; calculate the parallel equivalent, giving 40uH + 40mF, and the DC gain
&gt; would be 61.5

&gt; Note that the effective inductor ESR is the sum of the two; for the
&gt; caps, it turns out to be that of a single 10mF cap, as each 20mF cap is
&gt; 2 in parallel (ESR_20mF = 0.5*ESR_10mF) so the sum is ESR_10mF

&gt; You can usually ignore the choke ESR. Because it has the full output
&gt; current flowing thru it, the choke is (usually, not always) designed for
&gt; extremely low losses (hence low ESR). if its not quite negligible, the
&gt; next approximation is to add it to the cap ESR. Or you can just use the
&gt; actual transfer function:

&gt; The AC transfer function of the power stage is:

&gt; Vout(s)/Vc(s) = Xc(s)/[Xc(s) + Xl(s)]

&gt; Xc(s) = ESR_C = 1/(s*C)

&gt; Xl(s) = ESR_L + s*L

&gt; (s = j*w)

&gt; the zener resistor current is 11mA c.f. a shunt circuit maximum of

&gt; Ishunt_max = (12 - 1.2 - 2.5)/2k2 = 8.3mA

&gt; this is a lot higher than your 5mA figure. I guesstimated Vled = 1.2V.
&gt; The TL431 cant pull lower than 2.5V.

&gt; regardless, 8.3mA &lt; 11mA, so the zener will clamp the opto supply at ~
&gt; 12V, and it wont vary by much.

&gt; the LED will see a maximum of 8.3mA - 1.2mA (the 1k resistor) = 7.1mA.

&gt; OK, we've established the zener shunt regulator works.

&gt; The TL431 circuit transfer function (from Vout to Vk) is:

&gt; Vk(s)/Vout(s) = -Zf(s)/Zin(s)

&gt; // = parallel

&gt; Zf(s) = [1/(s*220pF)]//(47k + 1/(s*22nF))

&gt; Zin(s) = 47k + 47k//[1/(s*22nF)]

&gt; the transfer function from Vk to Iled is simply -1/2k2

&gt; so Iled(s)/Vout(s) = (1/2k2)*Zf(s)/Zin(s)

&gt; the transfer function from the opto transistor to led is:

&gt; Ibjt(s)/Iled(s) = CTR*1/(1+s/w_opto)

&gt; where w_opto is the corner frequency of the opto itself. You probably
&gt; cant ignore this.

&gt; and to get from the opto bjt to the control voltage, the transfer
&gt; function is Acl(s)*(-8k2)

&gt; its -8k2 because the voltage is (5V - 8k2*Ibjt), and the 5V (being
&gt; constant) disappears when you take partial derivatives.

&gt; where Acl(s) is the error amplifier closed-loop gain. for a shitty old
&gt; smps controller, these error amplifiers can have quite low GBW. look it
&gt; up in the datasheet, but I suspect you can ignore it as the gain is one.

&gt; Acl(s) = 1/(1+s/(2*pi*GBW))

&gt; OK, I looked it up, its 1MHz so you can safely ignore the controller
&gt; error amp, and set

&gt; Acl(s) = 1.

&gt; Putting it all together, you get:

&gt; Vc(s)/Vout(s) = 1*(-8k2)*CTR*[1/(1+s/w_opto)]*(1/2k2)*Zf(s)/Zin(s)

&gt; simplifying:

&gt; Vc(s)/Vout(s) = -3.73*CTR*[1/(1+s/w_opto)]*Zf(s)/Zin(s)

&gt; and thats all you need to close your loop.

&gt; I might have made an algebraic error or 6, but the technique is pretty
&gt; much there. If I was being paid, I'd be very careful to get it right :)

&gt; Cheers
&gt; Terry- Dölj citerad text -

&gt; - Visa citerad text -
">

Thanks Terry,

I'll go through your calculations and try to understand.

Again, thanks

Stefan
</POST>
</TEXT>
</BODY>
</DOC>
