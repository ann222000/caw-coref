<DOC>
<DOCID> eng-NG-31-126389-7094058 </DOCID>
<DOCTYPE SOURCE="usenet"> USENET TEXT </DOCTYPE>
<DATETIME> 2007-04-14T20:35:00 </DATETIME>
<BODY>
<HEADLINE>
Hot unpluging CF Card and USB Thumb Drive in Linux 2.6
</HEADLINE>
<TEXT>
<POST>
<POSTER> dcho...@hotmail.com </POSTER>
<POSTDATE> 2007-04-14T20:35:00 </POSTDATE>
I have Monte Vista Linux 2.6 running on a TI Davinci board. The CF
card mounts on /dev/hda1, and the USB thumb drive mounts on /dev/sda1.

I have 2 questions regarding unplugging the devices without first
doing an umount...

1. When I unplug the USB thumb drive and then plug it back in, I found
that I need to mount it on /dev/sdb1 instead of /dev/sda1. If i repeat
the process, it goes to /dev/sdc1.

How does an application program normally handle hot unplugging of a
USB thumb drive (without umount first)? When mounting it again, does
it just step through the device names from sda1 to whatever, until it
successfully opens the device?

2. When I unplug the CF card and then plug it back in, I found that I
am unable to then remount it again. It keeps giving me errors like:
end_request: I/O error, dev hda, sector 63
FAT: unable to read boot sector
mount: /dev/hda1: can't read superblock

In this case, it does not just mount on say /dev/hdb1 and so forth...

How does an application program recover from such a situation if it is
unavoidable that the user may unplug the CF card without first doing
an umount?

Is there any sample hotplug code that I can review and possibly port
to the platform?

Thanks
</POST>
</TEXT>
</BODY>
</DOC>
